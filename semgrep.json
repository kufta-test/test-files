{"errors": [], "interfile_languages_used": ["Go", "JavaScript"], "paths": {"scanned": [".DS_Store", ".github/.DS_Store", ".github/workflows/semgrep.yaml", "README.md", "go/gorilla-command-injection-taint.go", "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "javascript/hardcoded-bearer-token.js", "semgrep.log"]}, "results": [{"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 6, "line": 38, "offset": 980}, "extra": {"engine_kind": "PRO", "fingerprint": "cc96ed0a6b16e0b3647cf39b4bbad0561b75ef95f119bc2142bae728f5e9080e0d5166bb25a1448d45554d07e95da08cab1f5aa9079d0f719df69c618e54be46_0", "is_ignored": false, "lines": "    cmd := &exec.Cmd {\n        // Path is the path of the command to run.\n        // ruleid: gorilla-command-injection-taint\n        Path: email,\n        // Args holds command line arguments, including the command as Args[0].\n        Args: []string{ \"tr\", \"--help\" },\n        Stdout: os.Stdout,\n        Stderr: os.Stderr,\n    }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "email", "end": {"col": 20, "line": 33, "offset": 797}, "propagated_value": {"svalue_abstract_content": "session.Values[\"email\"]", "svalue_end": {"col": 37, "line": 28, "offset": 651}, "svalue_start": {"col": 14, "line": 28, "offset": 628}}, "start": {"col": 15, "line": 33, "offset": 792}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 13, "line": 30, "offset": 665}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 20, "line": 33, "offset": 797}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "email", "location": {"end": {"col": 10, "line": 28, "offset": 624}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 28, "offset": 619}}}], "taint_sink": ["CliLoc", [{"end": {"col": 20, "line": 33, "offset": 797}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 33, "offset": 792}}, "email"]], "taint_source": ["CliLoc", [{"end": {"col": 28, "line": 28, "offset": 642}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 14, "line": 28, "offset": 628}}, "session.Values"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_0", "is_ignored": false, "lines": "        Path: email,", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$INPUT": {"abstract_content": "email", "end": {"col": 20, "line": 33, "offset": 797}, "propagated_value": {"svalue_abstract_content": "session.Values[\"email\"]", "svalue_end": {"col": 37, "line": 28, "offset": 651}, "svalue_start": {"col": 14, "line": 28, "offset": 628}}, "start": {"col": 15, "line": 33, "offset": 792}}, "$SESSION": {"abstract_content": "session", "end": {"col": 21, "line": 28, "offset": 635}, "start": {"col": 14, "line": 28, "offset": 628}}, "$STORE": {"abstract_content": "store", "end": {"col": 23, "line": 22, "offset": 500}, "start": {"col": 18, "line": 22, "offset": 495}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 33, "offset": 792}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 47, "line": 50, "offset": 1284}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "email", "location": {"end": {"col": 10, "line": 28, "offset": 624}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 28, "offset": 619}}}, {"content": "cmd3Input", "location": {"end": {"col": 14, "line": 47, "offset": 1158}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 47, "offset": 1149}}}], "taint_sink": ["CliLoc", [{"end": {"col": 47, "line": 50, "offset": 1284}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 50, "offset": 1242}}, "cmd3Writer.Write([]byte(cmd3Input + \"\\n\"))"]], "taint_source": ["CliLoc", [{"end": {"col": 28, "line": 28, "offset": 642}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 14, "line": 28, "offset": 628}}, "session.Values"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_1", "is_ignored": false, "lines": "    cmd3Writer.Write([]byte(cmd3Input + \"\\n\"))", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$1": {"abstract_content": "bash", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CMD_STRUCT": {"abstract_content": "cmd3", "end": {"col": 26, "line": 45, "offset": 1115}, "propagated_value": {"svalue_abstract_content": "exec.Command(\"bash\")", "svalue_end": {"col": 33, "line": 44, "offset": 1089}, "svalue_start": {"col": 13, "line": 44, "offset": 1069}}, "start": {"col": 22, "line": 45, "offset": 1111}}, "$SESSION": {"abstract_content": "session", "end": {"col": 21, "line": 28, "offset": 635}, "start": {"col": 14, "line": 28, "offset": 628}}, "$SHELL": {"abstract_content": "bash", "end": {"col": 31, "line": 44, "offset": 1087}, "start": {"col": 27, "line": 44, "offset": 1083}}, "$STORE": {"abstract_content": "store", "end": {"col": 23, "line": 22, "offset": 500}, "start": {"col": 18, "line": 22, "offset": 495}}, "$WRITER": {"abstract_content": "cmd3Writer", "end": {"col": 15, "line": 50, "offset": 1252}, "start": {"col": 5, "line": 50, "offset": 1242}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 50, "offset": 1242}}, {"check_id": "go.lang.security.audit.dangerous-command-write.dangerous-command-write", "end": {"col": 47, "line": 50, "offset": 1284}, "extra": {"engine_kind": "PRO", "fingerprint": "99658f66523f5b02f679015129ec49e7c675568bb3c4fa29dd5bd9c21e9307a7b8254d3e3606e11b8a6231e2a64fb38f5bef45390f720c949c8a236e42a27cab_0", "is_ignored": false, "lines": "    cmd3Writer.Write([]byte(cmd3Input + \"\\n\"))", "message": "Detected non-static command inside Write. Audit the input to 'cmd3Writer.Write'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9107, "rule_id": "pKUOZ9", "rule_name": "go.lang.security.audit.dangerous-command-write.dangerous-command-write", "rv_id": 833843, "url": "https://semgrep.dev/playground/r/JdTlr07/go.lang.security.audit.dangerous-command-write.dangerous-command-write", "version_id": "JdTlr07"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-command-write.dangerous-command-write", "shortlink": "https://sg.run/Bko5", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-command-write.dangerous-command-write", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$BYTE": {"abstract_content": "[]byte(cmd3Input+\"\\n\"", "end": {"col": 46, "line": 50, "offset": 1283}, "start": {"col": 22, "line": 50, "offset": 1259}}, "$CMD": {"abstract_content": "cmd3", "end": {"col": 26, "line": 45, "offset": 1115}, "propagated_value": {"svalue_abstract_content": "exec.Command(\"bash\")", "svalue_end": {"col": 33, "line": 44, "offset": 1089}, "svalue_start": {"col": 13, "line": 44, "offset": 1069}}, "start": {"col": 22, "line": 45, "offset": 1111}}, "$CW": {"abstract_content": "cmd3Writer", "end": {"col": 15, "line": 50, "offset": 1252}, "start": {"col": 5, "line": 50, "offset": 1242}}, "$ERR": {"abstract_content": "_", "end": {"col": 18, "line": 45, "offset": 1107}, "start": {"col": 17, "line": 45, "offset": 1106}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 50, "offset": 1242}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 41, "line": 53, "offset": 1373}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "email", "location": {"end": {"col": 10, "line": 28, "offset": 624}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 28, "offset": 619}}}, {"content": "cmd3Input", "location": {"end": {"col": 14, "line": 47, "offset": 1158}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 47, "offset": 1149}}}], "taint_sink": ["CliLoc", [{"end": {"col": 41, "line": 53, "offset": 1373}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 32, "line": 53, "offset": 1364}}, "cmd3Input"]], "taint_source": ["CliLoc", [{"end": {"col": 28, "line": 28, "offset": 642}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 14, "line": 28, "offset": 628}}, "session.Values"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_2", "is_ignored": false, "lines": "    io.WriteString(cmd3Writer, cmd3Input)", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$1": {"abstract_content": "bash", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CMD_STRUCT": {"abstract_content": "cmd3", "end": {"col": 26, "line": 45, "offset": 1115}, "propagated_value": {"svalue_abstract_content": "exec.Command(\"bash\")", "svalue_end": {"col": 33, "line": 44, "offset": 1089}, "svalue_start": {"col": 13, "line": 44, "offset": 1069}}, "start": {"col": 22, "line": 45, "offset": 1111}}, "$SESSION": {"abstract_content": "session", "end": {"col": 21, "line": 28, "offset": 635}, "start": {"col": 14, "line": 28, "offset": 628}}, "$SHELL": {"abstract_content": "bash", "end": {"col": 31, "line": 44, "offset": 1087}, "start": {"col": 27, "line": 44, "offset": 1083}}, "$SHELLCMD": {"abstract_content": "cmd3Input", "end": {"col": 41, "line": 53, "offset": 1373}, "propagated_value": {"svalue_abstract_content": "fmt.Sprintf(\"ls %s\"email)", "svalue_end": {"col": 45, "line": 47, "offset": 1189}, "svalue_start": {"col": 18, "line": 47, "offset": 1162}}, "start": {"col": 32, "line": 53, "offset": 1364}}, "$STORE": {"abstract_content": "store", "end": {"col": 23, "line": 22, "offset": 500}, "start": {"col": 18, "line": 22, "offset": 495}}, "$WRITER": {"abstract_content": "cmd3Writer", "end": {"col": 30, "line": 53, "offset": 1362}, "start": {"col": 20, "line": 53, "offset": 1352}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 32, "line": 53, "offset": 1364}}, {"check_id": "go.lang.security.audit.dangerous-syscall-exec.dangerous-syscall-exec", "end": {"col": 38, "line": 57, "offset": 1498}, "extra": {"engine_kind": "PRO", "fingerprint": "8dca8164af7906b03561afb317771ea36b6cf067ad4d4c87052a5499359d2506326c0141cfd7782d67e959b29f35b482f96b86af40819ae6bf1df0268ad0d141_0", "is_ignored": false, "lines": "    syscall.Exec(\"echo \" + cmd4Input)", "message": "Detected non-static command inside Exec. Audit the input to 'syscall.Exec'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9110, "rule_id": "j2UvPl", "rule_name": "go.lang.security.audit.dangerous-syscall-exec.dangerous-syscall-exec", "rv_id": 833846, "url": "https://semgrep.dev/playground/r/RGTKGye/go.lang.security.audit.dangerous-syscall-exec.dangerous-syscall-exec", "version_id": "RGTKGye"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-syscall-exec.dangerous-syscall-exec", "shortlink": "https://sg.run/0QRb", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-syscall-exec.dangerous-syscall-exec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$1": {"abstract_content": "Exec", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$BIN": {"abstract_content": "\"echo \"+cmd4Input", "end": {"col": 37, "line": 57, "offset": 1497}, "start": {"col": 18, "line": 57, "offset": 1478}}, "$METHOD": {"abstract_content": "Exec", "end": {"col": 17, "line": 57, "offset": 1477}, "start": {"col": 13, "line": 57, "offset": 1473}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 57, "offset": 1465}}, {"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 6, "line": 82, "offset": 2074}, "extra": {"engine_kind": "PRO", "fingerprint": "4d993d35de97caaadae8e34fbce1b44a8fe9f4bb2d10b53cf07c4dc2b7a9b7579e6d7441df953024d07c24e7d3b7b587ce2f585849d274b0f6f0e43f9ed2ec10_0", "is_ignored": false, "lines": "    cmd := &exec.Cmd {\n        // Path is the path of the command to run.\n        // ruleid: gorilla-command-injection-taint\n        Path: person.Name,\n        // Args holds command line arguments, including the command as Args[0].\n        Args: []string{ \"tr\", \"--help\" },\n        Stdout: os.Stdout,\n        Stderr: os.Stderr,\n    }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "person.Name", "end": {"col": 26, "line": 77, "offset": 1891}, "start": {"col": 15, "line": 77, "offset": 1880}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 13, "line": 74, "offset": 1753}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 26, "line": 77, "offset": 1891}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 26, "line": 77, "offset": 1891}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 77, "offset": 1880}}, "person.Name"]], "taint_source": ["CliLoc", [{"end": {"col": 21, "line": 77, "offset": 1886}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 77, "offset": 1880}}, "person"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_3", "is_ignored": false, "lines": "        Path: person.Name,", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$DECODER": {"abstract_content": "decoder", "end": {"col": 19, "line": 71, "offset": 1710}, "start": {"col": 12, "line": 71, "offset": 1703}}, "$INPUT": {"abstract_content": "person.Name", "end": {"col": 26, "line": 77, "offset": 1891}, "start": {"col": 15, "line": 77, "offset": 1880}}, "$TO": {"abstract_content": "person", "end": {"col": 21, "line": 77, "offset": 1886}, "start": {"col": 15, "line": 77, "offset": 1880}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 77, "offset": 1880}}, {"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 14, "line": 113, "offset": 3081}, "extra": {"engine_kind": "PRO", "fingerprint": "d0bf327480d2c53052476adcfa181c629c8257a55d92fb6667e64098bf42bec9b294aa58e09edfecee5bec5cb12044ccf3b557268609cee01680b0a3566cce11_0", "is_ignored": false, "lines": "            cmd := &exec.Cmd {\n                // Path is the path of the command to run.\n                // ruleid: gorilla-command-injection-taint\n                Path: value[\"foo\"],\n                // Args holds command line arguments, including the command as Args[0].\n                Args: []string{ \"tr\", \"--help\" },\n                Stdout: os.Stdout,\n                Stderr: os.Stderr,\n            }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "value[\"foo\"]", "end": {"col": 35, "line": 108, "offset": 2858}, "start": {"col": 23, "line": 108, "offset": 2846}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 21, "line": 105, "offset": 2695}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 35, "line": 108, "offset": 2858}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 35, "line": 108, "offset": 2858}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 23, "line": 108, "offset": 2846}}, "value[\"foo\"]"]], "taint_source": ["CliLoc", [{"end": {"col": 28, "line": 108, "offset": 2851}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 23, "line": 108, "offset": 2846}}, "value"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_4", "is_ignored": false, "lines": "                Path: value[\"foo\"],", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$C": {"abstract_content": "cookie.Value", "end": {"col": 48, "line": 103, "offset": 2650}, "start": {"col": 36, "line": 103, "offset": 2638}}, "$COOKIE": {"abstract_content": "s", "end": {"col": 13, "line": 103, "offset": 2615}, "propagated_value": {"svalue_abstract_content": "securecookie.New(hashKey blockKey)", "svalue_end": {"col": 48, "line": 97, "offset": 2507}, "svalue_start": {"col": 13, "line": 97, "offset": 2472}}, "start": {"col": 12, "line": 103, "offset": 2614}}, "$INPUT": {"abstract_content": "value[\"foo\"]", "end": {"col": 35, "line": 108, "offset": 2858}, "start": {"col": 23, "line": 108, "offset": 2846}}, "$NAME": {"abstract_content": "\"cookie-name\"", "end": {"col": 34, "line": 103, "offset": 2636}, "start": {"col": 21, "line": 103, "offset": 2623}}, "$VALUE": {"abstract_content": "value", "end": {"col": 28, "line": 108, "offset": 2851}, "propagated_value": {"svalue_abstract_content": "(map[string]string)", "svalue_end": {"col": 35, "line": 101, "offset": 2601}, "svalue_start": {"col": 16, "line": 101, "offset": 2582}}, "start": {"col": 23, "line": 108, "offset": 2846}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 23, "line": 108, "offset": 2846}}, {"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 10, "line": 139, "offset": 3979}, "extra": {"engine_kind": "PRO", "fingerprint": "d0bf327480d2c53052476adcfa181c629c8257a55d92fb6667e64098bf42bec9b294aa58e09edfecee5bec5cb12044ccf3b557268609cee01680b0a3566cce11_1", "is_ignored": false, "lines": "        cmd := &exec.Cmd {\n            // Path is the path of the command to run.\n            // ruleid: gorilla-command-injection-taint\n            Path: value[\"foo\"],\n            // Args holds command line arguments, including the command as Args[0].\n            Args: []string{ \"tr\", \"--help\" },\n            Stdout: os.Stdout,\n            Stderr: os.Stderr,\n        }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "value[\"foo\"]", "end": {"col": 31, "line": 134, "offset": 3776}, "start": {"col": 19, "line": 134, "offset": 3764}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 17, "line": 131, "offset": 3625}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 31, "line": 134, "offset": 3776}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 31, "line": 134, "offset": 3776}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 19, "line": 134, "offset": 3764}}, "value[\"foo\"]"]], "taint_source": ["CliLoc", [{"end": {"col": 24, "line": 134, "offset": 3769}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 19, "line": 134, "offset": 3764}}, "value"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_5", "is_ignored": false, "lines": "            Path: value[\"foo\"],", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$C": {"abstract_content": "cookie.Value", "end": {"col": 67, "line": 129, "offset": 3557}, "start": {"col": 55, "line": 129, "offset": 3545}}, "$INPUT": {"abstract_content": "value[\"foo\"]", "end": {"col": 31, "line": 134, "offset": 3776}, "start": {"col": 19, "line": 134, "offset": 3764}}, "$NAME": {"abstract_content": "\"cookie-name\"", "end": {"col": 53, "line": 129, "offset": 3543}, "start": {"col": 40, "line": 129, "offset": 3530}}, "$VALUE": {"abstract_content": "value", "end": {"col": 24, "line": 134, "offset": 3769}, "propagated_value": {"svalue_abstract_content": "(map[string]string)", "svalue_end": {"col": 35, "line": 101, "offset": 2601}, "svalue_start": {"col": 16, "line": 101, "offset": 2582}}, "start": {"col": 19, "line": 134, "offset": 3764}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 19, "line": 134, "offset": 3764}}, {"check_id": "go.gorilla.security.audit.websocket-missing-origin-check.websocket-missing-origin-check", "end": {"col": 45, "line": 154, "offset": 4239}, "extra": {"engine_kind": "PRO", "fingerprint": "bb9e5897046561f4e0a2d4547275a47a64cfd8d286982b851c97c76575da12a7317ff29f7d1057db7b4c4bb0a5c5e8f22a4d6382a0d06d2f8f9faca01e336a91_0", "is_ignored": false, "lines": "    conn, err := upgrader.Upgrade(w, r, nil)", "message": "The Origin header in the HTTP WebSocket handshake is used to guarantee that the connection accepted by the WebSocket is from a trusted origin domain. Failure to enforce can lead to Cross Site Request Forgery (CSRF). As per \"gorilla/websocket\" documentation: \"A CheckOrigin function should carefully validate the request origin to prevent cross-site request forgery.\"", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-352: Cross-Site Request Forgery (CSRF)"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2021 - Broken Access Control"], "references": ["https://pkg.go.dev/github.com/gorilla/websocket#Upgrader"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 18430, "rule_id": "ReUKdz", "rule_name": "go.gorilla.security.audit.websocket-missing-origin-check.websocket-missing-origin-check", "rv_id": 833814, "url": "https://semgrep.dev/playground/r/zyTWJob/go.gorilla.security.audit.websocket-missing-origin-check.websocket-missing-origin-check", "version_id": "zyTWJob"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.security.audit.websocket-missing-origin-check.websocket-missing-origin-check", "shortlink": "https://sg.run/xXpz", "source": "https://semgrep.dev/r/go.gorilla.security.audit.websocket-missing-origin-check.websocket-missing-origin-check", "subcategory": ["audit"], "technology": ["gorilla"], "vulnerability_class": ["Cross-Site Request Forgery (CSRF)"]}, "metavars": {"$UPGRADER": {"abstract_content": "upgrader", "end": {"col": 26, "line": 154, "offset": 4220}, "start": {"col": 18, "line": 154, "offset": 4212}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 18, "line": 154, "offset": 4212}}, {"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 6, "line": 166, "offset": 4637}, "extra": {"engine_kind": "PRO", "fingerprint": "cc96ed0a6b16e0b3647cf39b4bbad0561b75ef95f119bc2142bae728f5e9080e0d5166bb25a1448d45554d07e95da08cab1f5aa9079d0f719df69c618e54be46_1", "is_ignored": false, "lines": "    cmd := &exec.Cmd {\n        // Path is the path of the command to run.\n        // ruleid: gorilla-command-injection-taint\n        Path: email,\n        // Args holds command line arguments, including the command as Args[0].\n        Args: []string{ \"tr\", \"--help\" },\n        Stdout: os.Stdout,\n        Stderr: os.Stderr,\n    }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "email", "end": {"col": 20, "line": 161, "offset": 4454}, "propagated_value": {"svalue_abstract_content": "string(p)", "svalue_end": {"col": 23, "line": 156, "offset": 4308}, "svalue_start": {"col": 14, "line": 156, "offset": 4299}}, "start": {"col": 15, "line": 161, "offset": 4449}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 13, "line": 158, "offset": 4322}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 20, "line": 161, "offset": 4454}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "p", "location": {"end": {"col": 19, "line": 155, "offset": 4258}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 18, "line": 155, "offset": 4257}}}, {"content": "email", "location": {"end": {"col": 10, "line": 156, "offset": 4295}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 156, "offset": 4290}}}], "taint_sink": ["CliLoc", [{"end": {"col": 20, "line": 161, "offset": 4454}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 161, "offset": 4449}}, "email"]], "taint_source": ["CliLoc", [{"end": {"col": 19, "line": 155, "offset": 4258}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 18, "line": 155, "offset": 4257}}, "p"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_6", "is_ignored": false, "lines": "        Path: email,", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$1": {"abstract_content": "ReadMessage", "end": {"col": 12, "line": 1, "offset": 11}, "start": {"col": 1, "line": 1, "offset": 0}}, "$BYTES": {"abstract_content": "p", "end": {"col": 19, "line": 155, "offset": 4258}, "start": {"col": 18, "line": 155, "offset": 4257}}, "$CONN": {"abstract_content": "conn", "end": {"col": 32, "line": 155, "offset": 4271}, "start": {"col": 28, "line": 155, "offset": 4267}}, "$ERR": {"abstract_content": "err", "end": {"col": 24, "line": 155, "offset": 4263}, "start": {"col": 21, "line": 155, "offset": 4260}}, "$FUNC": {"abstract_content": "ReadMessage", "end": {"col": 44, "line": 155, "offset": 4283}, "start": {"col": 33, "line": 155, "offset": 4272}}, "$INPUT": {"abstract_content": "email", "end": {"col": 20, "line": 161, "offset": 4454}, "propagated_value": {"svalue_abstract_content": "string(p)", "svalue_end": {"col": 23, "line": 156, "offset": 4308}, "svalue_start": {"col": 14, "line": 156, "offset": 4299}}, "start": {"col": 15, "line": 161, "offset": 4449}}, "$TYPE": {"abstract_content": "messageType", "end": {"col": 16, "line": 155, "offset": 4255}, "start": {"col": 5, "line": 155, "offset": 4244}}, "$UPGRADER": {"abstract_content": "upgrader", "end": {"col": 26, "line": 154, "offset": 4220}, "start": {"col": 18, "line": 154, "offset": 4212}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 161, "offset": 4449}}, {"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 6, "line": 184, "offset": 5133}, "extra": {"engine_kind": "PRO", "fingerprint": "cc96ed0a6b16e0b3647cf39b4bbad0561b75ef95f119bc2142bae728f5e9080e0d5166bb25a1448d45554d07e95da08cab1f5aa9079d0f719df69c618e54be46_2", "is_ignored": false, "lines": "    cmd = &exec.Cmd {\n        // Path is the path of the command to run.\n        // ruleid: gorilla-command-injection-taint\n        Path: email,\n        // Args holds command line arguments, including the command as Args[0].\n        Args: []string{ \"tr\", \"--help\" },\n        Stdout: os.Stdout,\n        Stderr: os.Stderr,\n    }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "email", "end": {"col": 20, "line": 179, "offset": 4950}, "propagated_value": {"svalue_abstract_content": "string(buf)", "svalue_end": {"col": 24, "line": 174, "offset": 4805}, "svalue_start": {"col": 13, "line": 174, "offset": 4794}}, "start": {"col": 15, "line": 179, "offset": 4945}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 12, "line": 176, "offset": 4818}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 20, "line": 179, "offset": 4950}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "p", "location": {"end": {"col": 19, "line": 155, "offset": 4258}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 18, "line": 155, "offset": 4257}}}, {"content": "email", "location": {"end": {"col": 10, "line": 156, "offset": 4295}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 156, "offset": 4290}}}], "taint_sink": ["CliLoc", [{"end": {"col": 20, "line": 179, "offset": 4950}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 179, "offset": 4945}}, "email"]], "taint_source": ["CliLoc", [{"end": {"col": 19, "line": 155, "offset": 4258}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 18, "line": 155, "offset": 4257}}, "p"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_7", "is_ignored": false, "lines": "        Path: email,", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$1": {"abstract_content": "ReadMessage", "end": {"col": 12, "line": 1, "offset": 11}, "start": {"col": 1, "line": 1, "offset": 0}}, "$BYTES": {"abstract_content": "p", "end": {"col": 19, "line": 155, "offset": 4258}, "start": {"col": 18, "line": 155, "offset": 4257}}, "$CONN": {"abstract_content": "conn", "end": {"col": 32, "line": 155, "offset": 4271}, "start": {"col": 28, "line": 155, "offset": 4267}}, "$ERR": {"abstract_content": "err", "end": {"col": 24, "line": 155, "offset": 4263}, "start": {"col": 21, "line": 155, "offset": 4260}}, "$FUNC": {"abstract_content": "ReadMessage", "end": {"col": 44, "line": 155, "offset": 4283}, "start": {"col": 33, "line": 155, "offset": 4272}}, "$INPUT": {"abstract_content": "email", "end": {"col": 20, "line": 179, "offset": 4950}, "propagated_value": {"svalue_abstract_content": "string(buf)", "svalue_end": {"col": 24, "line": 174, "offset": 4805}, "svalue_start": {"col": 13, "line": 174, "offset": 4794}}, "start": {"col": 15, "line": 179, "offset": 4945}}, "$TYPE": {"abstract_content": "messageType", "end": {"col": 16, "line": 155, "offset": 4255}, "start": {"col": 5, "line": 155, "offset": 4244}}, "$UPGRADER": {"abstract_content": "upgrader", "end": {"col": 26, "line": 154, "offset": 4220}, "start": {"col": 18, "line": 154, "offset": 4212}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 179, "offset": 4945}}, {"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 6, "line": 213, "offset": 5942}, "extra": {"engine_kind": "PRO", "fingerprint": "cc96ed0a6b16e0b3647cf39b4bbad0561b75ef95f119bc2142bae728f5e9080e0d5166bb25a1448d45554d07e95da08cab1f5aa9079d0f719df69c618e54be46_3", "is_ignored": false, "lines": "    cmd := &exec.Cmd {\n        // Path is the path of the command to run.\n        // ruleid: gorilla-command-injection-taint\n        Path: email,\n        // Args holds command line arguments, including the command as Args[0].\n        Args: []string{ \"tr\", \"--help\" },\n        Stdout: os.Stdout,\n        Stderr: os.Stderr,\n    }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "email", "end": {"col": 20, "line": 208, "offset": 5759}, "propagated_value": {"svalue_abstract_content": "session.Values[\"email\"]", "svalue_end": {"col": 37, "line": 203, "offset": 5613}, "svalue_start": {"col": 14, "line": 203, "offset": 5590}}, "start": {"col": 15, "line": 208, "offset": 5754}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 13, "line": 205, "offset": 5627}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 20, "line": 208, "offset": 5759}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "email", "location": {"end": {"col": 10, "line": 203, "offset": 5586}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 203, "offset": 5581}}}], "taint_sink": ["CliLoc", [{"end": {"col": 20, "line": 208, "offset": 5759}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 208, "offset": 5754}}, "email"]], "taint_source": ["CliLoc", [{"end": {"col": 28, "line": 203, "offset": 5604}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 14, "line": 203, "offset": 5590}}, "session.Values"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_8", "is_ignored": false, "lines": "        Path: email,", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$INPUT": {"abstract_content": "email", "end": {"col": 20, "line": 208, "offset": 5759}, "propagated_value": {"svalue_abstract_content": "session.Values[\"email\"]", "svalue_end": {"col": 37, "line": 203, "offset": 5613}, "svalue_start": {"col": 14, "line": 203, "offset": 5590}}, "start": {"col": 15, "line": 208, "offset": 5754}}, "$SESSION": {"abstract_content": "session", "end": {"col": 21, "line": 203, "offset": 5597}, "start": {"col": 14, "line": 203, "offset": 5590}}, "$STORE": {"abstract_content": "store", "end": {"col": 23, "line": 197, "offset": 5462}, "start": {"col": 18, "line": 197, "offset": 5457}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 208, "offset": 5754}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 47, "line": 225, "offset": 6246}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "email", "location": {"end": {"col": 10, "line": 203, "offset": 5586}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 203, "offset": 5581}}}, {"content": "cmd3Input", "location": {"end": {"col": 14, "line": 222, "offset": 6120}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 222, "offset": 6111}}}], "taint_sink": ["CliLoc", [{"end": {"col": 47, "line": 225, "offset": 6246}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 225, "offset": 6204}}, "cmd3Writer.Write([]byte(cmd3Input + \"\\n\"))"]], "taint_source": ["CliLoc", [{"end": {"col": 28, "line": 203, "offset": 5604}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 14, "line": 203, "offset": 5590}}, "session.Values"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_9", "is_ignored": false, "lines": "    cmd3Writer.Write([]byte(cmd3Input + \"\\n\"))", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$1": {"abstract_content": "bash", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CMD_STRUCT": {"abstract_content": "cmd3", "end": {"col": 26, "line": 220, "offset": 6077}, "propagated_value": {"svalue_abstract_content": "exec.Command(\"bash\")", "svalue_end": {"col": 33, "line": 219, "offset": 6051}, "svalue_start": {"col": 13, "line": 219, "offset": 6031}}, "start": {"col": 22, "line": 220, "offset": 6073}}, "$SESSION": {"abstract_content": "session", "end": {"col": 21, "line": 203, "offset": 5597}, "start": {"col": 14, "line": 203, "offset": 5590}}, "$SHELL": {"abstract_content": "bash", "end": {"col": 31, "line": 219, "offset": 6049}, "start": {"col": 27, "line": 219, "offset": 6045}}, "$STORE": {"abstract_content": "store", "end": {"col": 23, "line": 197, "offset": 5462}, "start": {"col": 18, "line": 197, "offset": 5457}}, "$WRITER": {"abstract_content": "cmd3Writer", "end": {"col": 15, "line": 225, "offset": 6214}, "start": {"col": 5, "line": 225, "offset": 6204}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 225, "offset": 6204}}, {"check_id": "go.lang.security.audit.dangerous-command-write.dangerous-command-write", "end": {"col": 47, "line": 225, "offset": 6246}, "extra": {"engine_kind": "PRO", "fingerprint": "99658f66523f5b02f679015129ec49e7c675568bb3c4fa29dd5bd9c21e9307a7b8254d3e3606e11b8a6231e2a64fb38f5bef45390f720c949c8a236e42a27cab_1", "is_ignored": false, "lines": "    cmd3Writer.Write([]byte(cmd3Input + \"\\n\"))", "message": "Detected non-static command inside Write. Audit the input to 'cmd3Writer.Write'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9107, "rule_id": "pKUOZ9", "rule_name": "go.lang.security.audit.dangerous-command-write.dangerous-command-write", "rv_id": 833843, "url": "https://semgrep.dev/playground/r/JdTlr07/go.lang.security.audit.dangerous-command-write.dangerous-command-write", "version_id": "JdTlr07"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-command-write.dangerous-command-write", "shortlink": "https://sg.run/Bko5", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-command-write.dangerous-command-write", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$BYTE": {"abstract_content": "[]byte(cmd3Input+\"\\n\"", "end": {"col": 46, "line": 225, "offset": 6245}, "start": {"col": 22, "line": 225, "offset": 6221}}, "$CMD": {"abstract_content": "cmd3", "end": {"col": 26, "line": 220, "offset": 6077}, "propagated_value": {"svalue_abstract_content": "exec.Command(\"bash\")", "svalue_end": {"col": 33, "line": 219, "offset": 6051}, "svalue_start": {"col": 13, "line": 219, "offset": 6031}}, "start": {"col": 22, "line": 220, "offset": 6073}}, "$CW": {"abstract_content": "cmd3Writer", "end": {"col": 15, "line": 225, "offset": 6214}, "start": {"col": 5, "line": 225, "offset": 6204}}, "$ERR": {"abstract_content": "_", "end": {"col": 18, "line": 220, "offset": 6069}, "start": {"col": 17, "line": 220, "offset": 6068}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 225, "offset": 6204}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 41, "line": 228, "offset": 6335}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "email", "location": {"end": {"col": 10, "line": 203, "offset": 5586}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 203, "offset": 5581}}}, {"content": "cmd3Input", "location": {"end": {"col": 14, "line": 222, "offset": 6120}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 222, "offset": 6111}}}], "taint_sink": ["CliLoc", [{"end": {"col": 41, "line": 228, "offset": 6335}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 32, "line": 228, "offset": 6326}}, "cmd3Input"]], "taint_source": ["CliLoc", [{"end": {"col": 28, "line": 203, "offset": 5604}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 14, "line": 203, "offset": 5590}}, "session.Values"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_10", "is_ignored": false, "lines": "    io.WriteString(cmd3Writer, cmd3Input)", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$1": {"abstract_content": "bash", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CMD_STRUCT": {"abstract_content": "cmd3", "end": {"col": 26, "line": 220, "offset": 6077}, "propagated_value": {"svalue_abstract_content": "exec.Command(\"bash\")", "svalue_end": {"col": 33, "line": 219, "offset": 6051}, "svalue_start": {"col": 13, "line": 219, "offset": 6031}}, "start": {"col": 22, "line": 220, "offset": 6073}}, "$SESSION": {"abstract_content": "session", "end": {"col": 21, "line": 203, "offset": 5597}, "start": {"col": 14, "line": 203, "offset": 5590}}, "$SHELL": {"abstract_content": "bash", "end": {"col": 31, "line": 219, "offset": 6049}, "start": {"col": 27, "line": 219, "offset": 6045}}, "$SHELLCMD": {"abstract_content": "cmd3Input", "end": {"col": 41, "line": 228, "offset": 6335}, "propagated_value": {"svalue_abstract_content": "fmt.Sprintf(\"ls %s\"email)", "svalue_end": {"col": 45, "line": 222, "offset": 6151}, "svalue_start": {"col": 18, "line": 222, "offset": 6124}}, "start": {"col": 32, "line": 228, "offset": 6326}}, "$STORE": {"abstract_content": "store", "end": {"col": 23, "line": 197, "offset": 5462}, "start": {"col": 18, "line": 197, "offset": 5457}}, "$WRITER": {"abstract_content": "cmd3Writer", "end": {"col": 30, "line": 228, "offset": 6324}, "start": {"col": 20, "line": 228, "offset": 6314}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 32, "line": 228, "offset": 6326}}, {"check_id": "go.lang.security.audit.dangerous-syscall-exec.dangerous-syscall-exec", "end": {"col": 38, "line": 232, "offset": 6460}, "extra": {"engine_kind": "PRO", "fingerprint": "8dca8164af7906b03561afb317771ea36b6cf067ad4d4c87052a5499359d2506326c0141cfd7782d67e959b29f35b482f96b86af40819ae6bf1df0268ad0d141_1", "is_ignored": false, "lines": "    syscall.Exec(\"echo \" + cmd4Input)", "message": "Detected non-static command inside Exec. Audit the input to 'syscall.Exec'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9110, "rule_id": "j2UvPl", "rule_name": "go.lang.security.audit.dangerous-syscall-exec.dangerous-syscall-exec", "rv_id": 833846, "url": "https://semgrep.dev/playground/r/RGTKGye/go.lang.security.audit.dangerous-syscall-exec.dangerous-syscall-exec", "version_id": "RGTKGye"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-syscall-exec.dangerous-syscall-exec", "shortlink": "https://sg.run/0QRb", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-syscall-exec.dangerous-syscall-exec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$1": {"abstract_content": "Exec", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$BIN": {"abstract_content": "\"echo \"+cmd4Input", "end": {"col": 37, "line": 232, "offset": 6459}, "start": {"col": 18, "line": 232, "offset": 6440}}, "$METHOD": {"abstract_content": "Exec", "end": {"col": 17, "line": 232, "offset": 6439}, "start": {"col": 13, "line": 232, "offset": 6435}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 232, "offset": 6427}}, {"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 6, "line": 257, "offset": 7036}, "extra": {"engine_kind": "PRO", "fingerprint": "4d993d35de97caaadae8e34fbce1b44a8fe9f4bb2d10b53cf07c4dc2b7a9b7579e6d7441df953024d07c24e7d3b7b587ce2f585849d274b0f6f0e43f9ed2ec10_1", "is_ignored": false, "lines": "    cmd := &exec.Cmd {\n        // Path is the path of the command to run.\n        // ruleid: gorilla-command-injection-taint\n        Path: person.Name,\n        // Args holds command line arguments, including the command as Args[0].\n        Args: []string{ \"tr\", \"--help\" },\n        Stdout: os.Stdout,\n        Stderr: os.Stderr,\n    }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "person.Name", "end": {"col": 26, "line": 252, "offset": 6853}, "start": {"col": 15, "line": 252, "offset": 6842}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 13, "line": 249, "offset": 6715}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 26, "line": 252, "offset": 6853}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 26, "line": 252, "offset": 6853}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 252, "offset": 6842}}, "person.Name"]], "taint_source": ["CliLoc", [{"end": {"col": 21, "line": 252, "offset": 6848}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 252, "offset": 6842}}, "person"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_11", "is_ignored": false, "lines": "        Path: person.Name,", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$DECODER": {"abstract_content": "decoder", "end": {"col": 19, "line": 246, "offset": 6672}, "start": {"col": 12, "line": 246, "offset": 6665}}, "$INPUT": {"abstract_content": "person.Name", "end": {"col": 26, "line": 252, "offset": 6853}, "start": {"col": 15, "line": 252, "offset": 6842}}, "$TO": {"abstract_content": "person", "end": {"col": 21, "line": 252, "offset": 6848}, "start": {"col": 15, "line": 252, "offset": 6842}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 252, "offset": 6842}}, {"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 14, "line": 288, "offset": 8043}, "extra": {"engine_kind": "PRO", "fingerprint": "d0bf327480d2c53052476adcfa181c629c8257a55d92fb6667e64098bf42bec9b294aa58e09edfecee5bec5cb12044ccf3b557268609cee01680b0a3566cce11_2", "is_ignored": false, "lines": "            cmd := &exec.Cmd {\n                // Path is the path of the command to run.\n                // ruleid: gorilla-command-injection-taint\n                Path: value[\"foo\"],\n                // Args holds command line arguments, including the command as Args[0].\n                Args: []string{ \"tr\", \"--help\" },\n                Stdout: os.Stdout,\n                Stderr: os.Stderr,\n            }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "value[\"foo\"]", "end": {"col": 35, "line": 283, "offset": 7820}, "start": {"col": 23, "line": 283, "offset": 7808}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 21, "line": 280, "offset": 7657}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 35, "line": 283, "offset": 7820}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 35, "line": 283, "offset": 7820}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 23, "line": 283, "offset": 7808}}, "value[\"foo\"]"]], "taint_source": ["CliLoc", [{"end": {"col": 28, "line": 283, "offset": 7813}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 23, "line": 283, "offset": 7808}}, "value"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_12", "is_ignored": false, "lines": "                Path: value[\"foo\"],", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$C": {"abstract_content": "cookie.Value", "end": {"col": 48, "line": 278, "offset": 7612}, "start": {"col": 36, "line": 278, "offset": 7600}}, "$COOKIE": {"abstract_content": "s", "end": {"col": 13, "line": 278, "offset": 7577}, "propagated_value": {"svalue_abstract_content": "securecookie.New(hashKey blockKey)", "svalue_end": {"col": 48, "line": 272, "offset": 7469}, "svalue_start": {"col": 13, "line": 272, "offset": 7434}}, "start": {"col": 12, "line": 278, "offset": 7576}}, "$INPUT": {"abstract_content": "value[\"foo\"]", "end": {"col": 35, "line": 283, "offset": 7820}, "start": {"col": 23, "line": 283, "offset": 7808}}, "$NAME": {"abstract_content": "\"cookie-name\"", "end": {"col": 34, "line": 278, "offset": 7598}, "start": {"col": 21, "line": 278, "offset": 7585}}, "$VALUE": {"abstract_content": "value", "end": {"col": 28, "line": 283, "offset": 7813}, "propagated_value": {"svalue_abstract_content": "(map[string]string)", "svalue_end": {"col": 35, "line": 276, "offset": 7563}, "svalue_start": {"col": 16, "line": 276, "offset": 7544}}, "start": {"col": 23, "line": 283, "offset": 7808}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 23, "line": 283, "offset": 7808}}, {"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 10, "line": 314, "offset": 8941}, "extra": {"engine_kind": "PRO", "fingerprint": "d0bf327480d2c53052476adcfa181c629c8257a55d92fb6667e64098bf42bec9b294aa58e09edfecee5bec5cb12044ccf3b557268609cee01680b0a3566cce11_3", "is_ignored": false, "lines": "        cmd := &exec.Cmd {\n            // Path is the path of the command to run.\n            // ruleid: gorilla-command-injection-taint\n            Path: value[\"foo\"],\n            // Args holds command line arguments, including the command as Args[0].\n            Args: []string{ \"tr\", \"--help\" },\n            Stdout: os.Stdout,\n            Stderr: os.Stderr,\n        }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "value[\"foo\"]", "end": {"col": 31, "line": 309, "offset": 8738}, "start": {"col": 19, "line": 309, "offset": 8726}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 17, "line": 306, "offset": 8587}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 31, "line": 309, "offset": 8738}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 31, "line": 309, "offset": 8738}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 19, "line": 309, "offset": 8726}}, "value[\"foo\"]"]], "taint_source": ["CliLoc", [{"end": {"col": 24, "line": 309, "offset": 8731}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 19, "line": 309, "offset": 8726}}, "value"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_13", "is_ignored": false, "lines": "            Path: value[\"foo\"],", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$C": {"abstract_content": "cookie.Value", "end": {"col": 67, "line": 304, "offset": 8519}, "start": {"col": 55, "line": 304, "offset": 8507}}, "$INPUT": {"abstract_content": "value[\"foo\"]", "end": {"col": 31, "line": 309, "offset": 8738}, "start": {"col": 19, "line": 309, "offset": 8726}}, "$NAME": {"abstract_content": "\"cookie-name\"", "end": {"col": 53, "line": 304, "offset": 8505}, "start": {"col": 40, "line": 304, "offset": 8492}}, "$VALUE": {"abstract_content": "value", "end": {"col": 24, "line": 309, "offset": 8731}, "propagated_value": {"svalue_abstract_content": "(map[string]string)", "svalue_end": {"col": 35, "line": 276, "offset": 7563}, "svalue_start": {"col": 16, "line": 276, "offset": 7544}}, "start": {"col": 19, "line": 309, "offset": 8726}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 19, "line": 309, "offset": 8726}}, {"check_id": "go.gorilla.security.audit.websocket-missing-origin-check.websocket-missing-origin-check", "end": {"col": 45, "line": 329, "offset": 9201}, "extra": {"engine_kind": "PRO", "fingerprint": "bb9e5897046561f4e0a2d4547275a47a64cfd8d286982b851c97c76575da12a7317ff29f7d1057db7b4c4bb0a5c5e8f22a4d6382a0d06d2f8f9faca01e336a91_1", "is_ignored": false, "lines": "    conn, err := upgrader.Upgrade(w, r, nil)", "message": "The Origin header in the HTTP WebSocket handshake is used to guarantee that the connection accepted by the WebSocket is from a trusted origin domain. Failure to enforce can lead to Cross Site Request Forgery (CSRF). As per \"gorilla/websocket\" documentation: \"A CheckOrigin function should carefully validate the request origin to prevent cross-site request forgery.\"", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-352: Cross-Site Request Forgery (CSRF)"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2021 - Broken Access Control"], "references": ["https://pkg.go.dev/github.com/gorilla/websocket#Upgrader"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 18430, "rule_id": "ReUKdz", "rule_name": "go.gorilla.security.audit.websocket-missing-origin-check.websocket-missing-origin-check", "rv_id": 833814, "url": "https://semgrep.dev/playground/r/zyTWJob/go.gorilla.security.audit.websocket-missing-origin-check.websocket-missing-origin-check", "version_id": "zyTWJob"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.security.audit.websocket-missing-origin-check.websocket-missing-origin-check", "shortlink": "https://sg.run/xXpz", "source": "https://semgrep.dev/r/go.gorilla.security.audit.websocket-missing-origin-check.websocket-missing-origin-check", "subcategory": ["audit"], "technology": ["gorilla"], "vulnerability_class": ["Cross-Site Request Forgery (CSRF)"]}, "metavars": {"$UPGRADER": {"abstract_content": "upgrader", "end": {"col": 26, "line": 329, "offset": 9182}, "start": {"col": 18, "line": 329, "offset": 9174}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 18, "line": 329, "offset": 9174}}, {"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 6, "line": 341, "offset": 9599}, "extra": {"engine_kind": "PRO", "fingerprint": "cc96ed0a6b16e0b3647cf39b4bbad0561b75ef95f119bc2142bae728f5e9080e0d5166bb25a1448d45554d07e95da08cab1f5aa9079d0f719df69c618e54be46_4", "is_ignored": false, "lines": "    cmd := &exec.Cmd {\n        // Path is the path of the command to run.\n        // ruleid: gorilla-command-injection-taint\n        Path: email,\n        // Args holds command line arguments, including the command as Args[0].\n        Args: []string{ \"tr\", \"--help\" },\n        Stdout: os.Stdout,\n        Stderr: os.Stderr,\n    }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "email", "end": {"col": 20, "line": 336, "offset": 9416}, "propagated_value": {"svalue_abstract_content": "string(p)", "svalue_end": {"col": 23, "line": 331, "offset": 9270}, "svalue_start": {"col": 14, "line": 331, "offset": 9261}}, "start": {"col": 15, "line": 336, "offset": 9411}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 13, "line": 333, "offset": 9284}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 20, "line": 336, "offset": 9416}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "p", "location": {"end": {"col": 19, "line": 330, "offset": 9220}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 18, "line": 330, "offset": 9219}}}, {"content": "email", "location": {"end": {"col": 10, "line": 331, "offset": 9257}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 331, "offset": 9252}}}], "taint_sink": ["CliLoc", [{"end": {"col": 20, "line": 336, "offset": 9416}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 336, "offset": 9411}}, "email"]], "taint_source": ["CliLoc", [{"end": {"col": 19, "line": 330, "offset": 9220}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 18, "line": 330, "offset": 9219}}, "p"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_14", "is_ignored": false, "lines": "        Path: email,", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$1": {"abstract_content": "ReadMessage", "end": {"col": 12, "line": 1, "offset": 11}, "start": {"col": 1, "line": 1, "offset": 0}}, "$BYTES": {"abstract_content": "p", "end": {"col": 19, "line": 330, "offset": 9220}, "start": {"col": 18, "line": 330, "offset": 9219}}, "$CONN": {"abstract_content": "conn", "end": {"col": 32, "line": 330, "offset": 9233}, "start": {"col": 28, "line": 330, "offset": 9229}}, "$ERR": {"abstract_content": "err", "end": {"col": 24, "line": 330, "offset": 9225}, "start": {"col": 21, "line": 330, "offset": 9222}}, "$FUNC": {"abstract_content": "ReadMessage", "end": {"col": 44, "line": 330, "offset": 9245}, "start": {"col": 33, "line": 330, "offset": 9234}}, "$INPUT": {"abstract_content": "email", "end": {"col": 20, "line": 336, "offset": 9416}, "propagated_value": {"svalue_abstract_content": "string(p)", "svalue_end": {"col": 23, "line": 331, "offset": 9270}, "svalue_start": {"col": 14, "line": 331, "offset": 9261}}, "start": {"col": 15, "line": 336, "offset": 9411}}, "$TYPE": {"abstract_content": "messageType", "end": {"col": 16, "line": 330, "offset": 9217}, "start": {"col": 5, "line": 330, "offset": 9206}}, "$UPGRADER": {"abstract_content": "upgrader", "end": {"col": 26, "line": 329, "offset": 9182}, "start": {"col": 18, "line": 329, "offset": 9174}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 336, "offset": 9411}}, {"check_id": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "end": {"col": 6, "line": 359, "offset": 10095}, "extra": {"engine_kind": "PRO", "fingerprint": "cc96ed0a6b16e0b3647cf39b4bbad0561b75ef95f119bc2142bae728f5e9080e0d5166bb25a1448d45554d07e95da08cab1f5aa9079d0f719df69c618e54be46_5", "is_ignored": false, "lines": "    cmd = &exec.Cmd {\n        // Path is the path of the command to run.\n        // ruleid: gorilla-command-injection-taint\n        Path: email,\n        // Args holds command line arguments, including the command as Args[0].\n        Args: []string{ \"tr\", \"--help\" },\n        Stdout: os.Stdout,\n        Stderr: os.Stderr,\n    }", "message": "Detected non-static command inside exec.Cmd. Audit the input to 'exec.Cmd'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9108, "rule_id": "2ZUb8l", "rule_name": "go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "rv_id": 833844, "url": "https://semgrep.dev/playground/r/5PTyDZJ/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "version_id": "5PTyDZJ"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "shortlink": "https://sg.run/Dorj", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-cmd.dangerous-exec-cmd", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "email", "end": {"col": 20, "line": 354, "offset": 9912}, "propagated_value": {"svalue_abstract_content": "string(buf)", "svalue_end": {"col": 24, "line": 349, "offset": 9767}, "svalue_start": {"col": 13, "line": 349, "offset": 9756}}, "start": {"col": 15, "line": 354, "offset": 9907}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 12, "line": 351, "offset": 9780}}, {"check_id": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "end": {"col": 20, "line": 354, "offset": 9912}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "p", "location": {"end": {"col": 19, "line": 330, "offset": 9220}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 18, "line": 330, "offset": 9219}}}, {"content": "email", "location": {"end": {"col": 10, "line": 331, "offset": 9257}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 5, "line": 331, "offset": 9252}}}], "taint_sink": ["CliLoc", [{"end": {"col": 20, "line": 354, "offset": 9912}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 354, "offset": 9907}}, "email"]], "taint_source": ["CliLoc", [{"end": {"col": 19, "line": 330, "offset": 9220}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 18, "line": 330, "offset": 9219}}, "p"]]}, "engine_kind": "PRO", "fingerprint": "545a0c19c52f044882a41d3ee9a3b50b878e3e7598d4fe165e6bbbba58559f10542491ffb326316ccbe58c6420c37b3ac7b8d4e2227be5567976f921858ad7ea_15", "is_ignored": false, "lines": "        Path: email,", "message": "Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. In Go, it is possible to use the `exec.Command` function in combination with the `bash -c` command to run the user input as a shell command. To sanitize the user input, you can use a library like `shellescape` to escape any special characters before constructing the command. For more information, see: [Go command injection prevention](https://semgrep.dev/docs/cheat-sheets/go-command-injection/)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "OS Command Injection with Gorilla", "functional-categories": ["net::source::network-connection::gorilla", "os::sink::os-command-or-thread::io", "os::sink::os-command-or-thread::os", "os::sink::os-command-or-thread::syscall", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "interfile": true, "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection", "https://pkg.go.dev/os/exec", "https://pkg.go.dev/syscall#Exec", "https://semgrep.dev/docs/cheat-sheets/go-command-injection/"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59522, "rule_id": "d8UXJG", "rule_name": "go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "rv_id": 924122, "url": "https://semgrep.dev/playground/r/O9TvbpW/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "version_id": "O9TvbpW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "shortlink": "https://sg.run/1w75", "source": "https://semgrep.dev/r/go.gorilla.command-injection.gorilla-command-injection-taint.gorilla-command-injection-taint", "subcategory": ["vuln"], "technology": ["go", "gorilla", "gorilla/sessions"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$1": {"abstract_content": "ReadMessage", "end": {"col": 12, "line": 1, "offset": 11}, "start": {"col": 1, "line": 1, "offset": 0}}, "$BYTES": {"abstract_content": "p", "end": {"col": 19, "line": 330, "offset": 9220}, "start": {"col": 18, "line": 330, "offset": 9219}}, "$CONN": {"abstract_content": "conn", "end": {"col": 32, "line": 330, "offset": 9233}, "start": {"col": 28, "line": 330, "offset": 9229}}, "$ERR": {"abstract_content": "err", "end": {"col": 24, "line": 330, "offset": 9225}, "start": {"col": 21, "line": 330, "offset": 9222}}, "$FUNC": {"abstract_content": "ReadMessage", "end": {"col": 44, "line": 330, "offset": 9245}, "start": {"col": 33, "line": 330, "offset": 9234}}, "$INPUT": {"abstract_content": "email", "end": {"col": 20, "line": 354, "offset": 9912}, "propagated_value": {"svalue_abstract_content": "string(buf)", "svalue_end": {"col": 24, "line": 349, "offset": 9767}, "svalue_start": {"col": 13, "line": 349, "offset": 9756}}, "start": {"col": 15, "line": 354, "offset": 9907}}, "$TYPE": {"abstract_content": "messageType", "end": {"col": 16, "line": 330, "offset": 9217}, "start": {"col": 5, "line": 330, "offset": 9206}}, "$UPGRADER": {"abstract_content": "upgrader", "end": {"col": 26, "line": 329, "offset": 9182}, "start": {"col": 18, "line": 329, "offset": 9174}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-command-injection-taint.go", "start": {"col": 15, "line": 354, "offset": 9907}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 59, "line": 31, "offset": 780}, "extra": {"engine_kind": "PRO", "fingerprint": "8028a55826aec7f701942e6976eaea85908b9ec578b4e71cdc54dc10a2b1c743314e4136fb1e5738a49ed278c0c7e184adbb5974713c62800e4ac5994f7f3244_0", "is_ignored": false, "lines": "    query := \"SELECT name FROM users WHERE email=\" + email", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rule_name": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "MyHandler", "end": {"col": 15, "line": 20, "offset": 374}, "start": {"col": 6, "line": 20, "offset": 365}}, "$OBJ": {"abstract_content": "db", "end": {"col": 4, "line": 33, "offset": 843}, "start": {"col": 2, "line": 33, "offset": 841}}, "$QUERY": {"abstract_content": "query", "end": {"col": 10, "line": 31, "offset": 731}, "start": {"col": 5, "line": 31, "offset": 726}}, "$X": {"abstract_content": "\"SELECT name FROM users WHERE email=\"", "end": {"col": 51, "line": 31, "offset": 772}, "start": {"col": 14, "line": 31, "offset": 735}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 5, "line": 31, "offset": 726}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 17, "line": 33, "offset": 856}, "extra": {"engine_kind": "PRO", "fingerprint": "d7e6c56c89a0008dd38196f7451d60decea3352dc8309cd58d2ad1dd6b66006533699e20e0957d4beca941e1d225589dd8b355e5762ce241f4b0601b5f40cc05_0", "is_ignored": false, "lines": "\tdb.Query(query)", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rule_name": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Query", "end": {"col": 6, "line": 1, "offset": 5}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 4, "line": 33, "offset": 843}, "start": {"col": 2, "line": 33, "offset": 841}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 10, "line": 33, "offset": 849}, "start": {"col": 5, "line": 33, "offset": 844}}, "$QUERY": {"abstract_content": "query", "end": {"col": 16, "line": 33, "offset": 855}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE email=\"+email", "svalue_end": {"col": 59, "line": 31, "offset": 780}, "svalue_start": {"col": 14, "line": 31, "offset": 735}}, "start": {"col": 11, "line": 33, "offset": 850}}, "$X": {"abstract_content": "\"SELECT name FROM users WHERE email=\"", "end": {"col": 51, "line": 31, "offset": 772}, "start": {"col": 14, "line": 31, "offset": 735}}, "$Y": {"abstract_content": "email", "end": {"col": 59, "line": 31, "offset": 780}, "propagated_value": {"svalue_abstract_content": "session.Values[\"email\"]", "svalue_end": {"col": 37, "line": 28, "offset": 656}, "svalue_start": {"col": 14, "line": 28, "offset": 633}}, "start": {"col": 54, "line": 31, "offset": 775}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 2, "line": 33, "offset": 841}}, {"check_id": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "end": {"col": 16, "line": 33, "offset": 855}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 16, "line": 33, "offset": 855}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 33, "offset": 850}}, "query"]], "taint_source": ["CliLoc", [{"end": {"col": 34, "line": 37, "offset": 911}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 1, "line": 3, "offset": 14}}, "import (\n    \"os\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"github.com/go-sql-driver/mysql\"\n\t\"database/sql\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/gorilla/schema\"\n    \"github.com/gorilla/rpc\"\n    \"github.com/gorilla/securecookie\"\n    \"github.com/gorilla/sessions\"\n)\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}\n\n// gorilla/schema\nvar decoder = schema.NewDecoder()"]]}, "engine_kind": "PRO", "fingerprint": "0a964f0a6bfe9b8cb134fab8040e946e84705bd6d838e58ac525fc85a854dba6ecec1f1c36064ea113b89ee9a190e884661c42dc040ac8b741a685da63cc6653_0", "is_ignored": false, "lines": "\tdb.Query(query)", "message": "Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions. When building SQL queries in Go, it is possible to adopt prepared statements by using the `Prepare` and `PrepareContext` calls with parameterized queries. For more information, see: [Prepared statements in Go](https://go.dev/doc/database/prepared-statements).", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "SQL Injection with Gorilla", "functional-categories": ["db::search::password::database", "db::search::password::gorm", "db::search::password::mysql", "db::search::password::pg", "db::search::password::pgx", "db::sink::sql-or-nosql-query::database", "net::source::network-connection::gorilla", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/", "https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59525, "rule_id": "EwU7zw", "rule_name": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "rv_id": 924125, "url": "https://semgrep.dev/playground/r/d6T6WyW/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "version_id": "d6T6WyW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "shortlink": "https://sg.run/rG9W", "source": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "subcategory": ["vuln"], "technology": ["github.com/gorilla/rpc/v2", "github.com/gorilla/schema", "github.com/gorilla/securecookie", "github.com/gorilla/sessions", "github.com/gorilla/websocket", "go", "gorilla", "gorilla/rpc", "gorilla/schema", "gorilla/securecookie", "gorilla/sessions", "gorilla/websocket"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Open", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 4, "line": 33, "offset": 843}, "start": {"col": 2, "line": 33, "offset": 841}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 10, "line": 33, "offset": 849}, "start": {"col": 5, "line": 33, "offset": 844}}, "$OPEN": {"abstract_content": "Open", "end": {"col": 21, "line": 30, "offset": 678}, "start": {"col": 17, "line": 30, "offset": 674}}, "$QUERY": {"abstract_content": "query", "end": {"col": 16, "line": 33, "offset": 855}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE email=\"+email", "svalue_end": {"col": 59, "line": 31, "offset": 780}, "svalue_start": {"col": 14, "line": 31, "offset": 735}}, "start": {"col": 11, "line": 33, "offset": 850}}, "$SESSION": {"abstract_content": "session", "end": {"col": 21, "line": 28, "offset": 640}, "start": {"col": 14, "line": 28, "offset": 633}}, "$STORE": {"abstract_content": "store", "end": {"col": 23, "line": 22, "offset": 505}, "start": {"col": 18, "line": 22, "offset": 500}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 33, "offset": 850}}, {"check_id": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "end": {"col": 16, "line": 33, "offset": 855}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 16, "line": 33, "offset": 855}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 33, "offset": 850}}, "query"]], "taint_source": ["CliLoc", [{"end": {"col": 34, "line": 37, "offset": 911}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 1, "line": 3, "offset": 14}}, "import (\n    \"os\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"github.com/go-sql-driver/mysql\"\n\t\"database/sql\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/gorilla/schema\"\n    \"github.com/gorilla/rpc\"\n    \"github.com/gorilla/securecookie\"\n    \"github.com/gorilla/sessions\"\n)\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}\n\n// gorilla/schema\nvar decoder = schema.NewDecoder()"]]}, "engine_kind": "PRO", "fingerprint": "a76f0507f5ad1fa2895cc324641352fe24fee68060ee39101409d5bab19ad8a8d596e1ee59e69f7579f191af64a91b0d9c9491373b0dd3302156e653e0a317e9_0", "is_ignored": false, "lines": "\tdb.Query(query)", "message": "Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions. When building SQL queries in Go, it is possible to adopt prepared statements by using the `Prepare` and `PrepareContext` calls with parameterized queries. For more information, see: [Prepared statements in Go](https://go.dev/doc/database/prepared-statements).", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "SQL Injection with Gorilla", "functional-categories": ["db::search::password::database", "db::search::password::gorm", "db::search::password::mysql", "db::search::password::pg", "db::search::password::pgx", "db::sink::sql-or-nosql-query::database", "net::source::network-connection::gorilla", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/", "https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59526, "rule_id": "7KU0kA", "rule_name": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "rv_id": 924126, "url": "https://semgrep.dev/playground/r/ZRTeZKr/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "version_id": "ZRTeZKr"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "shortlink": "https://sg.run/bdBQ", "source": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "subcategory": ["vuln"], "technology": ["database/sql", "github.com/gorilla/rpc/v2", "github.com/gorilla/schema", "github.com/gorilla/securecookie", "github.com/gorilla/sessions", "github.com/gorilla/websocket", "gorilla", "gorilla/rpc", "gorilla/schema", "gorilla/securecookie", "gorilla/sessions", "gorilla/websocket"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Open", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$A": {"abstract_content": "SELECT name FROM users WHERE email=", "end": {"col": 50, "line": 31, "offset": 771}, "start": {"col": 15, "line": 31, "offset": 736}}, "$B": {"abstract_content": "email", "end": {"col": 59, "line": 31, "offset": 780}, "propagated_value": {"svalue_abstract_content": "session.Values[\"email\"]", "svalue_end": {"col": 37, "line": 28, "offset": 656}, "svalue_start": {"col": 14, "line": 28, "offset": 633}}, "start": {"col": 54, "line": 31, "offset": 775}}, "$DB": {"abstract_content": "db", "end": {"col": 4, "line": 33, "offset": 843}, "start": {"col": 2, "line": 33, "offset": 841}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 10, "line": 33, "offset": 849}, "start": {"col": 5, "line": 33, "offset": 844}}, "$OPEN": {"abstract_content": "Open", "end": {"col": 21, "line": 30, "offset": 678}, "start": {"col": 17, "line": 30, "offset": 674}}, "$QUERY": {"abstract_content": "query", "end": {"col": 16, "line": 33, "offset": 855}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE email=\"+email", "svalue_end": {"col": 59, "line": 31, "offset": 780}, "svalue_start": {"col": 14, "line": 31, "offset": 735}}, "start": {"col": 11, "line": 33, "offset": 850}}, "$SESSION": {"abstract_content": "session", "end": {"col": 21, "line": 28, "offset": 640}, "start": {"col": 14, "line": 28, "offset": 633}}, "$STORE": {"abstract_content": "store", "end": {"col": 23, "line": 22, "offset": 505}, "start": {"col": 18, "line": 22, "offset": 500}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 33, "offset": 850}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 60, "line": 49, "offset": 1158}, "extra": {"engine_kind": "PRO", "fingerprint": "a764c0cd0b86447424b5bc627494646ddf7e79d68ca678d6e8c2c9675301e6459e563ef42da31981517b5e42f0b21b54cc5df0eea834cb6f45fb0ad806628ab5_0", "is_ignored": false, "lines": "\tquery := \"SELECT name FROM users WHERE age=\" + person.Name", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rule_name": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "MyHandler", "end": {"col": 15, "line": 44, "offset": 985}, "start": {"col": 6, "line": 44, "offset": 976}}, "$OBJ": {"abstract_content": "db", "end": {"col": 4, "line": 52, "offset": 1285}, "start": {"col": 2, "line": 52, "offset": 1283}}, "$QUERY": {"abstract_content": "query", "end": {"col": 7, "line": 49, "offset": 1105}, "start": {"col": 2, "line": 49, "offset": 1100}}, "$X": {"abstract_content": "\"SELECT name FROM users WHERE age=\"", "end": {"col": 46, "line": 49, "offset": 1144}, "start": {"col": 11, "line": 49, "offset": 1109}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 2, "line": 49, "offset": 1100}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 17, "line": 52, "offset": 1298}, "extra": {"engine_kind": "PRO", "fingerprint": "6a1600c6a6e99a37ac22338557affd67941d14dac844bcb740a4b4d9a1a0a6a7e787f67f1ebf24dbafc93a801d3734d5a912c5373dadf4f9ed38da3a9ffdcf46_0", "is_ignored": false, "lines": "\tdb.Query(query)", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rule_name": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Query", "end": {"col": 6, "line": 1, "offset": 5}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 4, "line": 52, "offset": 1285}, "start": {"col": 2, "line": 52, "offset": 1283}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 10, "line": 52, "offset": 1291}, "start": {"col": 5, "line": 52, "offset": 1286}}, "$QUERY": {"abstract_content": "query", "end": {"col": 16, "line": 52, "offset": 1297}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE age=\"+person.Name", "svalue_end": {"col": 60, "line": 49, "offset": 1158}, "svalue_start": {"col": 11, "line": 49, "offset": 1109}}, "start": {"col": 11, "line": 52, "offset": 1292}}, "$X": {"abstract_content": "\"SELECT name FROM users WHERE age=\"", "end": {"col": 46, "line": 49, "offset": 1144}, "start": {"col": 11, "line": 49, "offset": 1109}}, "$Y": {"abstract_content": "person.Name", "end": {"col": 60, "line": 49, "offset": 1158}, "start": {"col": 49, "line": 49, "offset": 1147}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 2, "line": 52, "offset": 1283}}, {"check_id": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "end": {"col": 16, "line": 52, "offset": 1297}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 16, "line": 52, "offset": 1297}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 52, "offset": 1292}}, "query"]], "taint_source": ["CliLoc", [{"end": {"col": 70, "line": 99, "offset": 2808}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 1, "line": 3, "offset": 14}}, "import (\n    \"os\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"github.com/go-sql-driver/mysql\"\n\t\"database/sql\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/gorilla/schema\"\n    \"github.com/gorilla/rpc\"\n    \"github.com/gorilla/securecookie\"\n    \"github.com/gorilla/sessions\"\n)\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}\n\n// gorilla/schema\nvar decoder = schema.NewDecoder()\n\ntype Person struct {\n    Name  string\n    Phone string\n}\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    var person Person\n    err := decoder.Decode(&person, r.PostForm)\n\n\n\tquery := \"SELECT name FROM users WHERE age=\" + person.Name\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n\treturn nil\n}\n\n// Gorilla securecookie\n\nfunc ReadCookieHandler(w http.ResponseWriter, r *http.Request) {\n\n    // Hash keys should be at least 32 bytes long\n    var hashKey = []byte(\"very-secret\")\n    // Block keys should be 16 bytes (AES-128) or 32 bytes (AES-256) long.\n    // Shorter keys may weaken the encryption used.\n    var blockKey = []byte(\"a-lot-secret\")\n    var s = securecookie.New(hashKey, blockKey)\n\n\tif cookie, err := r.Cookie(\"cookie-name\"); err == nil {\n\n\t\tvalue := make(map[string]string)\n\t\terr = s.Decode(\"cookie-name\", cookie.Value, &value);\n\n\t    db, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n        query := \"SELECT name FROM users WHERE age=\" + value[\"query\"]\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n        var cookies = map[string]*securecookie.SecureCookie{\n\t        \"previous\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n\t        \"current\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n        }\n\n        err = securecookie.DecodeMulti(\"cookie-name\", cookie.Value, &value, cookies[\"current\"], cookies[\"previous\"])\n\t    db, err = sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n\t}\n}\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))"]]}, "engine_kind": "PRO", "fingerprint": "0a964f0a6bfe9b8cb134fab8040e946e84705bd6d838e58ac525fc85a854dba6ecec1f1c36064ea113b89ee9a190e884661c42dc040ac8b741a685da63cc6653_1", "is_ignored": false, "lines": "\tdb.Query(query)", "message": "Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions. When building SQL queries in Go, it is possible to adopt prepared statements by using the `Prepare` and `PrepareContext` calls with parameterized queries. For more information, see: [Prepared statements in Go](https://go.dev/doc/database/prepared-statements).", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "SQL Injection with Gorilla", "functional-categories": ["db::search::password::database", "db::search::password::gorm", "db::search::password::mysql", "db::search::password::pg", "db::search::password::pgx", "db::sink::sql-or-nosql-query::database", "net::source::network-connection::gorilla", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/", "https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59525, "rule_id": "EwU7zw", "rule_name": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "rv_id": 924125, "url": "https://semgrep.dev/playground/r/d6T6WyW/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "version_id": "d6T6WyW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "shortlink": "https://sg.run/rG9W", "source": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "subcategory": ["vuln"], "technology": ["github.com/gorilla/rpc/v2", "github.com/gorilla/schema", "github.com/gorilla/securecookie", "github.com/gorilla/sessions", "github.com/gorilla/websocket", "go", "gorilla", "gorilla/rpc", "gorilla/schema", "gorilla/securecookie", "gorilla/sessions", "gorilla/websocket"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Open", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 4, "line": 52, "offset": 1285}, "start": {"col": 2, "line": 52, "offset": 1283}}, "$DECODER": {"abstract_content": "decoder", "end": {"col": 19, "line": 46, "offset": 1068}, "start": {"col": 12, "line": 46, "offset": 1061}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 10, "line": 52, "offset": 1291}, "start": {"col": 5, "line": 52, "offset": 1286}}, "$OPEN": {"abstract_content": "Open", "end": {"col": 21, "line": 50, "offset": 1179}, "start": {"col": 17, "line": 50, "offset": 1175}}, "$QUERY": {"abstract_content": "query", "end": {"col": 16, "line": 52, "offset": 1297}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE age=\"+person.Name", "svalue_end": {"col": 60, "line": 49, "offset": 1158}, "svalue_start": {"col": 11, "line": 49, "offset": 1109}}, "start": {"col": 11, "line": 52, "offset": 1292}}, "$TO": {"abstract_content": "person", "end": {"col": 55, "line": 49, "offset": 1153}, "start": {"col": 49, "line": 49, "offset": 1147}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 52, "offset": 1292}}, {"check_id": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "end": {"col": 16, "line": 52, "offset": 1297}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 16, "line": 52, "offset": 1297}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 52, "offset": 1292}}, "query"]], "taint_source": ["CliLoc", [{"end": {"col": 70, "line": 99, "offset": 2808}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 1, "line": 3, "offset": 14}}, "import (\n    \"os\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"github.com/go-sql-driver/mysql\"\n\t\"database/sql\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/gorilla/schema\"\n    \"github.com/gorilla/rpc\"\n    \"github.com/gorilla/securecookie\"\n    \"github.com/gorilla/sessions\"\n)\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}\n\n// gorilla/schema\nvar decoder = schema.NewDecoder()\n\ntype Person struct {\n    Name  string\n    Phone string\n}\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    var person Person\n    err := decoder.Decode(&person, r.PostForm)\n\n\n\tquery := \"SELECT name FROM users WHERE age=\" + person.Name\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n\treturn nil\n}\n\n// Gorilla securecookie\n\nfunc ReadCookieHandler(w http.ResponseWriter, r *http.Request) {\n\n    // Hash keys should be at least 32 bytes long\n    var hashKey = []byte(\"very-secret\")\n    // Block keys should be 16 bytes (AES-128) or 32 bytes (AES-256) long.\n    // Shorter keys may weaken the encryption used.\n    var blockKey = []byte(\"a-lot-secret\")\n    var s = securecookie.New(hashKey, blockKey)\n\n\tif cookie, err := r.Cookie(\"cookie-name\"); err == nil {\n\n\t\tvalue := make(map[string]string)\n\t\terr = s.Decode(\"cookie-name\", cookie.Value, &value);\n\n\t    db, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n        query := \"SELECT name FROM users WHERE age=\" + value[\"query\"]\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n        var cookies = map[string]*securecookie.SecureCookie{\n\t        \"previous\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n\t        \"current\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n        }\n\n        err = securecookie.DecodeMulti(\"cookie-name\", cookie.Value, &value, cookies[\"current\"], cookies[\"previous\"])\n\t    db, err = sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n\t}\n}\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))"]]}, "engine_kind": "PRO", "fingerprint": "a76f0507f5ad1fa2895cc324641352fe24fee68060ee39101409d5bab19ad8a8d596e1ee59e69f7579f191af64a91b0d9c9491373b0dd3302156e653e0a317e9_1", "is_ignored": false, "lines": "\tdb.Query(query)", "message": "Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions. When building SQL queries in Go, it is possible to adopt prepared statements by using the `Prepare` and `PrepareContext` calls with parameterized queries. For more information, see: [Prepared statements in Go](https://go.dev/doc/database/prepared-statements).", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "SQL Injection with Gorilla", "functional-categories": ["db::search::password::database", "db::search::password::gorm", "db::search::password::mysql", "db::search::password::pg", "db::search::password::pgx", "db::sink::sql-or-nosql-query::database", "net::source::network-connection::gorilla", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/", "https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59526, "rule_id": "7KU0kA", "rule_name": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "rv_id": 924126, "url": "https://semgrep.dev/playground/r/ZRTeZKr/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "version_id": "ZRTeZKr"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "shortlink": "https://sg.run/bdBQ", "source": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "subcategory": ["vuln"], "technology": ["database/sql", "github.com/gorilla/rpc/v2", "github.com/gorilla/schema", "github.com/gorilla/securecookie", "github.com/gorilla/sessions", "github.com/gorilla/websocket", "gorilla", "gorilla/rpc", "gorilla/schema", "gorilla/securecookie", "gorilla/sessions", "gorilla/websocket"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Open", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$A": {"abstract_content": "SELECT name FROM users WHERE age=", "end": {"col": 45, "line": 49, "offset": 1143}, "start": {"col": 12, "line": 49, "offset": 1110}}, "$B": {"abstract_content": "person.Name", "end": {"col": 60, "line": 49, "offset": 1158}, "start": {"col": 49, "line": 49, "offset": 1147}}, "$DB": {"abstract_content": "db", "end": {"col": 4, "line": 52, "offset": 1285}, "start": {"col": 2, "line": 52, "offset": 1283}}, "$DECODER": {"abstract_content": "decoder", "end": {"col": 19, "line": 46, "offset": 1068}, "start": {"col": 12, "line": 46, "offset": 1061}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 10, "line": 52, "offset": 1291}, "start": {"col": 5, "line": 52, "offset": 1286}}, "$OPEN": {"abstract_content": "Open", "end": {"col": 21, "line": 50, "offset": 1179}, "start": {"col": 17, "line": 50, "offset": 1175}}, "$QUERY": {"abstract_content": "query", "end": {"col": 16, "line": 52, "offset": 1297}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE age=\"+person.Name", "svalue_end": {"col": 60, "line": 49, "offset": 1158}, "svalue_start": {"col": 11, "line": 49, "offset": 1109}}, "start": {"col": 11, "line": 52, "offset": 1292}}, "$TO": {"abstract_content": "person", "end": {"col": 55, "line": 49, "offset": 1153}, "start": {"col": 49, "line": 49, "offset": 1147}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 52, "offset": 1292}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 70, "line": 73, "offset": 1999}, "extra": {"engine_kind": "PRO", "fingerprint": "3e606dcb30944430817a521f1c062e2b9635fb5fb404506bf6ce4997ad7d9adbbd56cf68c658cd846a0d6fa2b1bb9a5df5c039a14b8505cfc6ae30f38068c7bf_0", "is_ignored": false, "lines": "        query := \"SELECT name FROM users WHERE age=\" + value[\"query\"]", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rule_name": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "ReadCookieHandler", "end": {"col": 23, "line": 58, "offset": 1361}, "start": {"col": 6, "line": 58, "offset": 1344}}, "$OBJ": {"abstract_content": "db", "end": {"col": 8, "line": 75, "offset": 2070}, "start": {"col": 6, "line": 75, "offset": 2068}}, "$QUERY": {"abstract_content": "query", "end": {"col": 14, "line": 73, "offset": 1943}, "start": {"col": 9, "line": 73, "offset": 1938}}, "$X": {"abstract_content": "\"SELECT name FROM users WHERE age=\"", "end": {"col": 53, "line": 73, "offset": 1982}, "start": {"col": 18, "line": 73, "offset": 1947}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 9, "line": 73, "offset": 1938}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 21, "line": 75, "offset": 2083}, "extra": {"engine_kind": "PRO", "fingerprint": "839b5ec280fec6b89bf4944598841f78808beb00a555913f66a5e38bbaaa480f2061713c937f144e30942efd40119572632b383e6f3dd065e0724cfc740033bf_0", "is_ignored": false, "lines": "\t    db.Query(query)", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rule_name": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Query", "end": {"col": 6, "line": 1, "offset": 5}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 8, "line": 75, "offset": 2070}, "start": {"col": 6, "line": 75, "offset": 2068}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 14, "line": 75, "offset": 2076}, "start": {"col": 9, "line": 75, "offset": 2071}}, "$QUERY": {"abstract_content": "query", "end": {"col": 20, "line": 75, "offset": 2082}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE age=\"+value[\"query\"]", "svalue_end": {"col": 70, "line": 73, "offset": 1999}, "svalue_start": {"col": 18, "line": 73, "offset": 1947}}, "start": {"col": 15, "line": 75, "offset": 2077}}, "$X": {"abstract_content": "\"SELECT name FROM users WHERE age=\"", "end": {"col": 53, "line": 73, "offset": 1982}, "start": {"col": 18, "line": 73, "offset": 1947}}, "$Y": {"abstract_content": "value[\"query\"]", "end": {"col": 70, "line": 73, "offset": 1999}, "start": {"col": 56, "line": 73, "offset": 1985}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 6, "line": 75, "offset": 2068}}, {"check_id": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "end": {"col": 20, "line": 75, "offset": 2082}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 20, "line": 75, "offset": 2082}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 15, "line": 75, "offset": 2077}}, "query"]], "taint_source": ["CliLoc", [{"end": {"col": 70, "line": 99, "offset": 2808}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 1, "line": 3, "offset": 14}}, "import (\n    \"os\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"github.com/go-sql-driver/mysql\"\n\t\"database/sql\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/gorilla/schema\"\n    \"github.com/gorilla/rpc\"\n    \"github.com/gorilla/securecookie\"\n    \"github.com/gorilla/sessions\"\n)\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}\n\n// gorilla/schema\nvar decoder = schema.NewDecoder()\n\ntype Person struct {\n    Name  string\n    Phone string\n}\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    var person Person\n    err := decoder.Decode(&person, r.PostForm)\n\n\n\tquery := \"SELECT name FROM users WHERE age=\" + person.Name\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n\treturn nil\n}\n\n// Gorilla securecookie\n\nfunc ReadCookieHandler(w http.ResponseWriter, r *http.Request) {\n\n    // Hash keys should be at least 32 bytes long\n    var hashKey = []byte(\"very-secret\")\n    // Block keys should be 16 bytes (AES-128) or 32 bytes (AES-256) long.\n    // Shorter keys may weaken the encryption used.\n    var blockKey = []byte(\"a-lot-secret\")\n    var s = securecookie.New(hashKey, blockKey)\n\n\tif cookie, err := r.Cookie(\"cookie-name\"); err == nil {\n\n\t\tvalue := make(map[string]string)\n\t\terr = s.Decode(\"cookie-name\", cookie.Value, &value);\n\n\t    db, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n        query := \"SELECT name FROM users WHERE age=\" + value[\"query\"]\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n        var cookies = map[string]*securecookie.SecureCookie{\n\t        \"previous\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n\t        \"current\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n        }\n\n        err = securecookie.DecodeMulti(\"cookie-name\", cookie.Value, &value, cookies[\"current\"], cookies[\"previous\"])\n\t    db, err = sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n\t}\n}\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))"]]}, "engine_kind": "PRO", "fingerprint": "0a964f0a6bfe9b8cb134fab8040e946e84705bd6d838e58ac525fc85a854dba6ecec1f1c36064ea113b89ee9a190e884661c42dc040ac8b741a685da63cc6653_2", "is_ignored": false, "lines": "\t    db.Query(query)", "message": "Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions. When building SQL queries in Go, it is possible to adopt prepared statements by using the `Prepare` and `PrepareContext` calls with parameterized queries. For more information, see: [Prepared statements in Go](https://go.dev/doc/database/prepared-statements).", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "SQL Injection with Gorilla", "functional-categories": ["db::search::password::database", "db::search::password::gorm", "db::search::password::mysql", "db::search::password::pg", "db::search::password::pgx", "db::sink::sql-or-nosql-query::database", "net::source::network-connection::gorilla", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/", "https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59525, "rule_id": "EwU7zw", "rule_name": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "rv_id": 924125, "url": "https://semgrep.dev/playground/r/d6T6WyW/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "version_id": "d6T6WyW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "shortlink": "https://sg.run/rG9W", "source": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "subcategory": ["vuln"], "technology": ["github.com/gorilla/rpc/v2", "github.com/gorilla/schema", "github.com/gorilla/securecookie", "github.com/gorilla/sessions", "github.com/gorilla/websocket", "go", "gorilla", "gorilla/rpc", "gorilla/schema", "gorilla/securecookie", "gorilla/sessions", "gorilla/websocket"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Open", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$C": {"abstract_content": "cookie.Value", "end": {"col": 45, "line": 70, "offset": 1850}, "start": {"col": 33, "line": 70, "offset": 1838}}, "$COOKIE": {"abstract_content": "s", "end": {"col": 10, "line": 70, "offset": 1815}, "propagated_value": {"svalue_abstract_content": "securecookie.New(hashKey blockKey)", "svalue_end": {"col": 48, "line": 65, "offset": 1711}, "svalue_start": {"col": 13, "line": 65, "offset": 1676}}, "start": {"col": 9, "line": 70, "offset": 1814}}, "$DB": {"abstract_content": "db", "end": {"col": 8, "line": 75, "offset": 2070}, "start": {"col": 6, "line": 75, "offset": 2068}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 14, "line": 75, "offset": 2076}, "start": {"col": 9, "line": 75, "offset": 2071}}, "$NAME": {"abstract_content": "\"cookie-name\"", "end": {"col": 31, "line": 70, "offset": 1836}, "start": {"col": 18, "line": 70, "offset": 1823}}, "$OPEN": {"abstract_content": "Open", "end": {"col": 25, "line": 72, "offset": 1886}, "start": {"col": 21, "line": 72, "offset": 1882}}, "$QUERY": {"abstract_content": "query", "end": {"col": 20, "line": 75, "offset": 2082}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE age=\"+value[\"query\"]", "svalue_end": {"col": 70, "line": 73, "offset": 1999}, "svalue_start": {"col": 18, "line": 73, "offset": 1947}}, "start": {"col": 15, "line": 75, "offset": 2077}}, "$VALUE": {"abstract_content": "value", "end": {"col": 61, "line": 73, "offset": 1990}, "propagated_value": {"svalue_abstract_content": "(map[string]string)", "svalue_end": {"col": 35, "line": 69, "offset": 1805}, "svalue_start": {"col": 16, "line": 69, "offset": 1786}}, "start": {"col": 56, "line": 73, "offset": 1985}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 15, "line": 75, "offset": 2077}}, {"check_id": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "end": {"col": 20, "line": 75, "offset": 2082}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 20, "line": 75, "offset": 2082}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 15, "line": 75, "offset": 2077}}, "query"]], "taint_source": ["CliLoc", [{"end": {"col": 70, "line": 99, "offset": 2808}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 1, "line": 3, "offset": 14}}, "import (\n    \"os\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"github.com/go-sql-driver/mysql\"\n\t\"database/sql\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/gorilla/schema\"\n    \"github.com/gorilla/rpc\"\n    \"github.com/gorilla/securecookie\"\n    \"github.com/gorilla/sessions\"\n)\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}\n\n// gorilla/schema\nvar decoder = schema.NewDecoder()\n\ntype Person struct {\n    Name  string\n    Phone string\n}\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    var person Person\n    err := decoder.Decode(&person, r.PostForm)\n\n\n\tquery := \"SELECT name FROM users WHERE age=\" + person.Name\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n\treturn nil\n}\n\n// Gorilla securecookie\n\nfunc ReadCookieHandler(w http.ResponseWriter, r *http.Request) {\n\n    // Hash keys should be at least 32 bytes long\n    var hashKey = []byte(\"very-secret\")\n    // Block keys should be 16 bytes (AES-128) or 32 bytes (AES-256) long.\n    // Shorter keys may weaken the encryption used.\n    var blockKey = []byte(\"a-lot-secret\")\n    var s = securecookie.New(hashKey, blockKey)\n\n\tif cookie, err := r.Cookie(\"cookie-name\"); err == nil {\n\n\t\tvalue := make(map[string]string)\n\t\terr = s.Decode(\"cookie-name\", cookie.Value, &value);\n\n\t    db, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n        query := \"SELECT name FROM users WHERE age=\" + value[\"query\"]\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n        var cookies = map[string]*securecookie.SecureCookie{\n\t        \"previous\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n\t        \"current\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n        }\n\n        err = securecookie.DecodeMulti(\"cookie-name\", cookie.Value, &value, cookies[\"current\"], cookies[\"previous\"])\n\t    db, err = sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n\t}\n}\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))"]]}, "engine_kind": "PRO", "fingerprint": "a76f0507f5ad1fa2895cc324641352fe24fee68060ee39101409d5bab19ad8a8d596e1ee59e69f7579f191af64a91b0d9c9491373b0dd3302156e653e0a317e9_2", "is_ignored": false, "lines": "\t    db.Query(query)", "message": "Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions. When building SQL queries in Go, it is possible to adopt prepared statements by using the `Prepare` and `PrepareContext` calls with parameterized queries. For more information, see: [Prepared statements in Go](https://go.dev/doc/database/prepared-statements).", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "SQL Injection with Gorilla", "functional-categories": ["db::search::password::database", "db::search::password::gorm", "db::search::password::mysql", "db::search::password::pg", "db::search::password::pgx", "db::sink::sql-or-nosql-query::database", "net::source::network-connection::gorilla", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/", "https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59526, "rule_id": "7KU0kA", "rule_name": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "rv_id": 924126, "url": "https://semgrep.dev/playground/r/ZRTeZKr/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "version_id": "ZRTeZKr"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "shortlink": "https://sg.run/bdBQ", "source": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "subcategory": ["vuln"], "technology": ["database/sql", "github.com/gorilla/rpc/v2", "github.com/gorilla/schema", "github.com/gorilla/securecookie", "github.com/gorilla/sessions", "github.com/gorilla/websocket", "gorilla", "gorilla/rpc", "gorilla/schema", "gorilla/securecookie", "gorilla/sessions", "gorilla/websocket"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Open", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$A": {"abstract_content": "SELECT name FROM users WHERE age=", "end": {"col": 52, "line": 73, "offset": 1981}, "start": {"col": 19, "line": 73, "offset": 1948}}, "$B": {"abstract_content": "value[\"query\"]", "end": {"col": 70, "line": 73, "offset": 1999}, "start": {"col": 56, "line": 73, "offset": 1985}}, "$C": {"abstract_content": "cookie.Value", "end": {"col": 45, "line": 70, "offset": 1850}, "start": {"col": 33, "line": 70, "offset": 1838}}, "$COOKIE": {"abstract_content": "s", "end": {"col": 10, "line": 70, "offset": 1815}, "propagated_value": {"svalue_abstract_content": "securecookie.New(hashKey blockKey)", "svalue_end": {"col": 48, "line": 65, "offset": 1711}, "svalue_start": {"col": 13, "line": 65, "offset": 1676}}, "start": {"col": 9, "line": 70, "offset": 1814}}, "$DB": {"abstract_content": "db", "end": {"col": 8, "line": 75, "offset": 2070}, "start": {"col": 6, "line": 75, "offset": 2068}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 14, "line": 75, "offset": 2076}, "start": {"col": 9, "line": 75, "offset": 2071}}, "$NAME": {"abstract_content": "\"cookie-name\"", "end": {"col": 31, "line": 70, "offset": 1836}, "start": {"col": 18, "line": 70, "offset": 1823}}, "$OPEN": {"abstract_content": "Open", "end": {"col": 25, "line": 72, "offset": 1886}, "start": {"col": 21, "line": 72, "offset": 1882}}, "$QUERY": {"abstract_content": "query", "end": {"col": 20, "line": 75, "offset": 2082}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE age=\"+value[\"query\"]", "svalue_end": {"col": 70, "line": 73, "offset": 1999}, "svalue_start": {"col": 18, "line": 73, "offset": 1947}}, "start": {"col": 15, "line": 75, "offset": 2077}}, "$VALUE": {"abstract_content": "value", "end": {"col": 61, "line": 73, "offset": 1990}, "propagated_value": {"svalue_abstract_content": "(map[string]string)", "svalue_end": {"col": 35, "line": 69, "offset": 1805}, "svalue_start": {"col": 16, "line": 69, "offset": 1786}}, "start": {"col": 56, "line": 73, "offset": 1985}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 15, "line": 75, "offset": 2077}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 21, "line": 92, "offset": 2710}, "extra": {"engine_kind": "PRO", "fingerprint": "839b5ec280fec6b89bf4944598841f78808beb00a555913f66a5e38bbaaa480f2061713c937f144e30942efd40119572632b383e6f3dd065e0724cfc740033bf_1", "is_ignored": false, "lines": "\t    db.Query(query)", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rule_name": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Query", "end": {"col": 6, "line": 1, "offset": 5}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 8, "line": 92, "offset": 2697}, "start": {"col": 6, "line": 92, "offset": 2695}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 14, "line": 92, "offset": 2703}, "start": {"col": 9, "line": 92, "offset": 2698}}, "$QUERY": {"abstract_content": "query", "end": {"col": 20, "line": 92, "offset": 2709}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE age=\"+value[\"query\"]", "svalue_end": {"col": 70, "line": 73, "offset": 1999}, "svalue_start": {"col": 18, "line": 73, "offset": 1947}}, "start": {"col": 15, "line": 92, "offset": 2704}}, "$X": {"abstract_content": "\"SELECT name FROM users WHERE age=\"", "end": {"col": 53, "line": 73, "offset": 1982}, "start": {"col": 18, "line": 73, "offset": 1947}}, "$Y": {"abstract_content": "value[\"query\"]", "end": {"col": 70, "line": 73, "offset": 1999}, "start": {"col": 56, "line": 73, "offset": 1985}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 6, "line": 92, "offset": 2695}}, {"check_id": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "end": {"col": 20, "line": 92, "offset": 2709}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 20, "line": 92, "offset": 2709}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 15, "line": 92, "offset": 2704}}, "query"]], "taint_source": ["CliLoc", [{"end": {"col": 70, "line": 99, "offset": 2808}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 1, "line": 3, "offset": 14}}, "import (\n    \"os\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"github.com/go-sql-driver/mysql\"\n\t\"database/sql\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/gorilla/schema\"\n    \"github.com/gorilla/rpc\"\n    \"github.com/gorilla/securecookie\"\n    \"github.com/gorilla/sessions\"\n)\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}\n\n// gorilla/schema\nvar decoder = schema.NewDecoder()\n\ntype Person struct {\n    Name  string\n    Phone string\n}\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    var person Person\n    err := decoder.Decode(&person, r.PostForm)\n\n\n\tquery := \"SELECT name FROM users WHERE age=\" + person.Name\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n\treturn nil\n}\n\n// Gorilla securecookie\n\nfunc ReadCookieHandler(w http.ResponseWriter, r *http.Request) {\n\n    // Hash keys should be at least 32 bytes long\n    var hashKey = []byte(\"very-secret\")\n    // Block keys should be 16 bytes (AES-128) or 32 bytes (AES-256) long.\n    // Shorter keys may weaken the encryption used.\n    var blockKey = []byte(\"a-lot-secret\")\n    var s = securecookie.New(hashKey, blockKey)\n\n\tif cookie, err := r.Cookie(\"cookie-name\"); err == nil {\n\n\t\tvalue := make(map[string]string)\n\t\terr = s.Decode(\"cookie-name\", cookie.Value, &value);\n\n\t    db, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n        query := \"SELECT name FROM users WHERE age=\" + value[\"query\"]\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n        var cookies = map[string]*securecookie.SecureCookie{\n\t        \"previous\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n\t        \"current\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n        }\n\n        err = securecookie.DecodeMulti(\"cookie-name\", cookie.Value, &value, cookies[\"current\"], cookies[\"previous\"])\n\t    db, err = sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n\t}\n}\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))"]]}, "engine_kind": "PRO", "fingerprint": "0a964f0a6bfe9b8cb134fab8040e946e84705bd6d838e58ac525fc85a854dba6ecec1f1c36064ea113b89ee9a190e884661c42dc040ac8b741a685da63cc6653_3", "is_ignored": false, "lines": "\t    db.Query(query)", "message": "Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions. When building SQL queries in Go, it is possible to adopt prepared statements by using the `Prepare` and `PrepareContext` calls with parameterized queries. For more information, see: [Prepared statements in Go](https://go.dev/doc/database/prepared-statements).", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "SQL Injection with Gorilla", "functional-categories": ["db::search::password::database", "db::search::password::gorm", "db::search::password::mysql", "db::search::password::pg", "db::search::password::pgx", "db::sink::sql-or-nosql-query::database", "net::source::network-connection::gorilla", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/", "https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59525, "rule_id": "EwU7zw", "rule_name": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "rv_id": 924125, "url": "https://semgrep.dev/playground/r/d6T6WyW/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "version_id": "d6T6WyW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "shortlink": "https://sg.run/rG9W", "source": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "subcategory": ["vuln"], "technology": ["github.com/gorilla/rpc/v2", "github.com/gorilla/schema", "github.com/gorilla/securecookie", "github.com/gorilla/sessions", "github.com/gorilla/websocket", "go", "gorilla", "gorilla/rpc", "gorilla/schema", "gorilla/securecookie", "gorilla/sessions", "gorilla/websocket"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Open", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$C": {"abstract_content": "cookie.Value", "end": {"col": 45, "line": 70, "offset": 1850}, "start": {"col": 33, "line": 70, "offset": 1838}}, "$COOKIE": {"abstract_content": "s", "end": {"col": 10, "line": 70, "offset": 1815}, "propagated_value": {"svalue_abstract_content": "securecookie.New(hashKey blockKey)", "svalue_end": {"col": 48, "line": 65, "offset": 1711}, "svalue_start": {"col": 13, "line": 65, "offset": 1676}}, "start": {"col": 9, "line": 70, "offset": 1814}}, "$DB": {"abstract_content": "db", "end": {"col": 8, "line": 92, "offset": 2697}, "start": {"col": 6, "line": 92, "offset": 2695}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 14, "line": 92, "offset": 2703}, "start": {"col": 9, "line": 92, "offset": 2698}}, "$NAME": {"abstract_content": "\"cookie-name\"", "end": {"col": 31, "line": 70, "offset": 1836}, "start": {"col": 18, "line": 70, "offset": 1823}}, "$OPEN": {"abstract_content": "Open", "end": {"col": 25, "line": 72, "offset": 1886}, "start": {"col": 21, "line": 72, "offset": 1882}}, "$QUERY": {"abstract_content": "query", "end": {"col": 20, "line": 92, "offset": 2709}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE age=\"+value[\"query\"]", "svalue_end": {"col": 70, "line": 73, "offset": 1999}, "svalue_start": {"col": 18, "line": 73, "offset": 1947}}, "start": {"col": 15, "line": 92, "offset": 2704}}, "$VALUE": {"abstract_content": "value", "end": {"col": 61, "line": 73, "offset": 1990}, "propagated_value": {"svalue_abstract_content": "(map[string]string)", "svalue_end": {"col": 35, "line": 69, "offset": 1805}, "svalue_start": {"col": 16, "line": 69, "offset": 1786}}, "start": {"col": 56, "line": 73, "offset": 1985}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 15, "line": 92, "offset": 2704}}, {"check_id": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "end": {"col": 20, "line": 92, "offset": 2709}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 20, "line": 92, "offset": 2709}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 15, "line": 92, "offset": 2704}}, "query"]], "taint_source": ["CliLoc", [{"end": {"col": 70, "line": 99, "offset": 2808}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 1, "line": 3, "offset": 14}}, "import (\n    \"os\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"github.com/go-sql-driver/mysql\"\n\t\"database/sql\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/gorilla/schema\"\n    \"github.com/gorilla/rpc\"\n    \"github.com/gorilla/securecookie\"\n    \"github.com/gorilla/sessions\"\n)\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}\n\n// gorilla/schema\nvar decoder = schema.NewDecoder()\n\ntype Person struct {\n    Name  string\n    Phone string\n}\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    var person Person\n    err := decoder.Decode(&person, r.PostForm)\n\n\n\tquery := \"SELECT name FROM users WHERE age=\" + person.Name\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n\treturn nil\n}\n\n// Gorilla securecookie\n\nfunc ReadCookieHandler(w http.ResponseWriter, r *http.Request) {\n\n    // Hash keys should be at least 32 bytes long\n    var hashKey = []byte(\"very-secret\")\n    // Block keys should be 16 bytes (AES-128) or 32 bytes (AES-256) long.\n    // Shorter keys may weaken the encryption used.\n    var blockKey = []byte(\"a-lot-secret\")\n    var s = securecookie.New(hashKey, blockKey)\n\n\tif cookie, err := r.Cookie(\"cookie-name\"); err == nil {\n\n\t\tvalue := make(map[string]string)\n\t\terr = s.Decode(\"cookie-name\", cookie.Value, &value);\n\n\t    db, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n        query := \"SELECT name FROM users WHERE age=\" + value[\"query\"]\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n        var cookies = map[string]*securecookie.SecureCookie{\n\t        \"previous\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n\t        \"current\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n        }\n\n        err = securecookie.DecodeMulti(\"cookie-name\", cookie.Value, &value, cookies[\"current\"], cookies[\"previous\"])\n\t    db, err = sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n\t}\n}\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))"]]}, "engine_kind": "PRO", "fingerprint": "a76f0507f5ad1fa2895cc324641352fe24fee68060ee39101409d5bab19ad8a8d596e1ee59e69f7579f191af64a91b0d9c9491373b0dd3302156e653e0a317e9_3", "is_ignored": false, "lines": "\t    db.Query(query)", "message": "Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions. When building SQL queries in Go, it is possible to adopt prepared statements by using the `Prepare` and `PrepareContext` calls with parameterized queries. For more information, see: [Prepared statements in Go](https://go.dev/doc/database/prepared-statements).", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "SQL Injection with Gorilla", "functional-categories": ["db::search::password::database", "db::search::password::gorm", "db::search::password::mysql", "db::search::password::pg", "db::search::password::pgx", "db::sink::sql-or-nosql-query::database", "net::source::network-connection::gorilla", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/", "https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59526, "rule_id": "7KU0kA", "rule_name": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "rv_id": 924126, "url": "https://semgrep.dev/playground/r/ZRTeZKr/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "version_id": "ZRTeZKr"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "shortlink": "https://sg.run/bdBQ", "source": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "subcategory": ["vuln"], "technology": ["database/sql", "github.com/gorilla/rpc/v2", "github.com/gorilla/schema", "github.com/gorilla/securecookie", "github.com/gorilla/sessions", "github.com/gorilla/websocket", "gorilla", "gorilla/rpc", "gorilla/schema", "gorilla/securecookie", "gorilla/sessions", "gorilla/websocket"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Open", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$A": {"abstract_content": "SELECT name FROM users WHERE age=", "end": {"col": 52, "line": 73, "offset": 1981}, "start": {"col": 19, "line": 73, "offset": 1948}}, "$B": {"abstract_content": "value[\"query\"]", "end": {"col": 70, "line": 73, "offset": 1999}, "start": {"col": 56, "line": 73, "offset": 1985}}, "$C": {"abstract_content": "cookie.Value", "end": {"col": 45, "line": 70, "offset": 1850}, "start": {"col": 33, "line": 70, "offset": 1838}}, "$COOKIE": {"abstract_content": "s", "end": {"col": 10, "line": 70, "offset": 1815}, "propagated_value": {"svalue_abstract_content": "securecookie.New(hashKey blockKey)", "svalue_end": {"col": 48, "line": 65, "offset": 1711}, "svalue_start": {"col": 13, "line": 65, "offset": 1676}}, "start": {"col": 9, "line": 70, "offset": 1814}}, "$DB": {"abstract_content": "db", "end": {"col": 8, "line": 92, "offset": 2697}, "start": {"col": 6, "line": 92, "offset": 2695}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 14, "line": 92, "offset": 2703}, "start": {"col": 9, "line": 92, "offset": 2698}}, "$NAME": {"abstract_content": "\"cookie-name\"", "end": {"col": 31, "line": 70, "offset": 1836}, "start": {"col": 18, "line": 70, "offset": 1823}}, "$OPEN": {"abstract_content": "Open", "end": {"col": 25, "line": 72, "offset": 1886}, "start": {"col": 21, "line": 72, "offset": 1882}}, "$QUERY": {"abstract_content": "query", "end": {"col": 20, "line": 92, "offset": 2709}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE age=\"+value[\"query\"]", "svalue_end": {"col": 70, "line": 73, "offset": 1999}, "svalue_start": {"col": 18, "line": 73, "offset": 1947}}, "start": {"col": 15, "line": 92, "offset": 2704}}, "$VALUE": {"abstract_content": "value", "end": {"col": 61, "line": 73, "offset": 1990}, "propagated_value": {"svalue_abstract_content": "(map[string]string)", "svalue_end": {"col": 35, "line": 69, "offset": 1805}, "svalue_start": {"col": 16, "line": 69, "offset": 1786}}, "start": {"col": 56, "line": 73, "offset": 1985}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 15, "line": 92, "offset": 2704}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 59, "line": 112, "offset": 3230}, "extra": {"engine_kind": "PRO", "fingerprint": "8028a55826aec7f701942e6976eaea85908b9ec578b4e71cdc54dc10a2b1c743314e4136fb1e5738a49ed278c0c7e184adbb5974713c62800e4ac5994f7f3244_1", "is_ignored": false, "lines": "    query := \"SELECT name FROM users WHERE email=\" + email", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rule_name": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "MyHandler", "end": {"col": 15, "line": 101, "offset": 2824}, "start": {"col": 6, "line": 101, "offset": 2815}}, "$OBJ": {"abstract_content": "db", "end": {"col": 4, "line": 114, "offset": 3293}, "start": {"col": 2, "line": 114, "offset": 3291}}, "$QUERY": {"abstract_content": "query", "end": {"col": 10, "line": 112, "offset": 3181}, "start": {"col": 5, "line": 112, "offset": 3176}}, "$X": {"abstract_content": "\"SELECT name FROM users WHERE email=\"", "end": {"col": 51, "line": 112, "offset": 3222}, "start": {"col": 14, "line": 112, "offset": 3185}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 5, "line": 112, "offset": 3176}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 17, "line": 114, "offset": 3306}, "extra": {"engine_kind": "PRO", "fingerprint": "d7e6c56c89a0008dd38196f7451d60decea3352dc8309cd58d2ad1dd6b66006533699e20e0957d4beca941e1d225589dd8b355e5762ce241f4b0601b5f40cc05_1", "is_ignored": false, "lines": "\tdb.Query(query)", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rule_name": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Query", "end": {"col": 6, "line": 1, "offset": 5}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 4, "line": 114, "offset": 3293}, "start": {"col": 2, "line": 114, "offset": 3291}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 10, "line": 114, "offset": 3299}, "start": {"col": 5, "line": 114, "offset": 3294}}, "$QUERY": {"abstract_content": "query", "end": {"col": 16, "line": 114, "offset": 3305}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE email=\"+email", "svalue_end": {"col": 59, "line": 112, "offset": 3230}, "svalue_start": {"col": 14, "line": 112, "offset": 3185}}, "start": {"col": 11, "line": 114, "offset": 3300}}, "$X": {"abstract_content": "\"SELECT name FROM users WHERE email=\"", "end": {"col": 51, "line": 112, "offset": 3222}, "start": {"col": 14, "line": 112, "offset": 3185}}, "$Y": {"abstract_content": "email", "end": {"col": 59, "line": 112, "offset": 3230}, "propagated_value": {"svalue_abstract_content": "session.Values[\"email\"]", "svalue_end": {"col": 37, "line": 109, "offset": 3106}, "svalue_start": {"col": 14, "line": 109, "offset": 3083}}, "start": {"col": 54, "line": 112, "offset": 3225}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 2, "line": 114, "offset": 3291}}, {"check_id": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "end": {"col": 16, "line": 114, "offset": 3305}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 16, "line": 114, "offset": 3305}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 114, "offset": 3300}}, "query"]], "taint_source": ["CliLoc", [{"end": {"col": 2, "line": 115, "offset": 3308}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 1, "line": 3, "offset": 14}}, "import (\n    \"os\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"github.com/go-sql-driver/mysql\"\n\t\"database/sql\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/gorilla/schema\"\n    \"github.com/gorilla/rpc\"\n    \"github.com/gorilla/securecookie\"\n    \"github.com/gorilla/sessions\"\n)\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}\n\n// gorilla/schema\nvar decoder = schema.NewDecoder()\n\ntype Person struct {\n    Name  string\n    Phone string\n}\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    var person Person\n    err := decoder.Decode(&person, r.PostForm)\n\n\n\tquery := \"SELECT name FROM users WHERE age=\" + person.Name\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n\treturn nil\n}\n\n// Gorilla securecookie\n\nfunc ReadCookieHandler(w http.ResponseWriter, r *http.Request) {\n\n    // Hash keys should be at least 32 bytes long\n    var hashKey = []byte(\"very-secret\")\n    // Block keys should be 16 bytes (AES-128) or 32 bytes (AES-256) long.\n    // Shorter keys may weaken the encryption used.\n    var blockKey = []byte(\"a-lot-secret\")\n    var s = securecookie.New(hashKey, blockKey)\n\n\tif cookie, err := r.Cookie(\"cookie-name\"); err == nil {\n\n\t\tvalue := make(map[string]string)\n\t\terr = s.Decode(\"cookie-name\", cookie.Value, &value);\n\n\t    db, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n        query := \"SELECT name FROM users WHERE age=\" + value[\"query\"]\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n        var cookies = map[string]*securecookie.SecureCookie{\n\t        \"previous\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n\t        \"current\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n        }\n\n        err = securecookie.DecodeMulti(\"cookie-name\", cookie.Value, &value, cookies[\"current\"], cookies[\"previous\"])\n\t    db, err = sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n\t}\n}\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}"]]}, "engine_kind": "PRO", "fingerprint": "0a964f0a6bfe9b8cb134fab8040e946e84705bd6d838e58ac525fc85a854dba6ecec1f1c36064ea113b89ee9a190e884661c42dc040ac8b741a685da63cc6653_4", "is_ignored": false, "lines": "\tdb.Query(query)", "message": "Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions. When building SQL queries in Go, it is possible to adopt prepared statements by using the `Prepare` and `PrepareContext` calls with parameterized queries. For more information, see: [Prepared statements in Go](https://go.dev/doc/database/prepared-statements).", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "SQL Injection with Gorilla", "functional-categories": ["db::search::password::database", "db::search::password::gorm", "db::search::password::mysql", "db::search::password::pg", "db::search::password::pgx", "db::sink::sql-or-nosql-query::database", "net::source::network-connection::gorilla", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/", "https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59525, "rule_id": "EwU7zw", "rule_name": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "rv_id": 924125, "url": "https://semgrep.dev/playground/r/d6T6WyW/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "version_id": "d6T6WyW"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "shortlink": "https://sg.run/rG9W", "source": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint-med-conf.gorilla-go-vanillasql-format-string-sqli-taint-med-conf", "subcategory": ["vuln"], "technology": ["github.com/gorilla/rpc/v2", "github.com/gorilla/schema", "github.com/gorilla/securecookie", "github.com/gorilla/sessions", "github.com/gorilla/websocket", "go", "gorilla", "gorilla/rpc", "gorilla/schema", "gorilla/securecookie", "gorilla/sessions", "gorilla/websocket"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Open", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 4, "line": 114, "offset": 3293}, "start": {"col": 2, "line": 114, "offset": 3291}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 10, "line": 114, "offset": 3299}, "start": {"col": 5, "line": 114, "offset": 3294}}, "$OPEN": {"abstract_content": "Open", "end": {"col": 21, "line": 111, "offset": 3128}, "start": {"col": 17, "line": 111, "offset": 3124}}, "$QUERY": {"abstract_content": "query", "end": {"col": 16, "line": 114, "offset": 3305}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE email=\"+email", "svalue_end": {"col": 59, "line": 112, "offset": 3230}, "svalue_start": {"col": 14, "line": 112, "offset": 3185}}, "start": {"col": 11, "line": 114, "offset": 3300}}, "$SESSION": {"abstract_content": "session", "end": {"col": 21, "line": 109, "offset": 3090}, "start": {"col": 14, "line": 109, "offset": 3083}}, "$STORE": {"abstract_content": "store", "end": {"col": 23, "line": 103, "offset": 2955}, "start": {"col": 18, "line": 103, "offset": 2950}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 114, "offset": 3300}}, {"check_id": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "end": {"col": 16, "line": 114, "offset": 3305}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 16, "line": 114, "offset": 3305}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 114, "offset": 3300}}, "query"]], "taint_source": ["CliLoc", [{"end": {"col": 2, "line": 115, "offset": 3308}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 1, "line": 3, "offset": 14}}, "import (\n    \"os\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"github.com/go-sql-driver/mysql\"\n\t\"database/sql\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/gorilla/schema\"\n    \"github.com/gorilla/rpc\"\n    \"github.com/gorilla/securecookie\"\n    \"github.com/gorilla/sessions\"\n)\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}\n\n// gorilla/schema\nvar decoder = schema.NewDecoder()\n\ntype Person struct {\n    Name  string\n    Phone string\n}\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    var person Person\n    err := decoder.Decode(&person, r.PostForm)\n\n\n\tquery := \"SELECT name FROM users WHERE age=\" + person.Name\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n\treturn nil\n}\n\n// Gorilla securecookie\n\nfunc ReadCookieHandler(w http.ResponseWriter, r *http.Request) {\n\n    // Hash keys should be at least 32 bytes long\n    var hashKey = []byte(\"very-secret\")\n    // Block keys should be 16 bytes (AES-128) or 32 bytes (AES-256) long.\n    // Shorter keys may weaken the encryption used.\n    var blockKey = []byte(\"a-lot-secret\")\n    var s = securecookie.New(hashKey, blockKey)\n\n\tif cookie, err := r.Cookie(\"cookie-name\"); err == nil {\n\n\t\tvalue := make(map[string]string)\n\t\terr = s.Decode(\"cookie-name\", cookie.Value, &value);\n\n\t    db, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n        query := \"SELECT name FROM users WHERE age=\" + value[\"query\"]\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n        var cookies = map[string]*securecookie.SecureCookie{\n\t        \"previous\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n\t        \"current\": securecookie.New(\n\t        \tsecurecookie.GenerateRandomKey(64),\n\t        \tsecurecookie.GenerateRandomKey(32),\n\t        ),\n        }\n\n        err = securecookie.DecodeMulti(\"cookie-name\", cookie.Value, &value, cookies[\"current\"], cookies[\"previous\"])\n\t    db, err = sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n\n\t    // ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\t    db.Query(query)\n\n\t}\n}\n\n// gorilla sessions\n\nvar store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n\t// Get a session. Get() always returns a session, even if empty.\n\tsession, err := store.Get(r, \"session-name\")\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n    email := session.Values[\"email\"]\n\n\tdb, err := sql.Open(\"mysql\", \"theUser:thePassword@/theDbName\")\n    query := \"SELECT name FROM users WHERE email=\" + email\n\t// ruleid: gorilla-go-vanillasql-format-string-sqli-taint\n\tdb.Query(query)\n}"]]}, "engine_kind": "PRO", "fingerprint": "a76f0507f5ad1fa2895cc324641352fe24fee68060ee39101409d5bab19ad8a8d596e1ee59e69f7579f191af64a91b0d9c9491373b0dd3302156e653e0a317e9_4", "is_ignored": false, "lines": "\tdb.Query(query)", "message": "Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions. When building SQL queries in Go, it is possible to adopt prepared statements by using the `Prepare` and `PrepareContext` calls with parameterized queries. For more information, see: [Prepared statements in Go](https://go.dev/doc/database/prepared-statements).", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2020-top25": true, "cwe2021-top25": true, "cwe2022-top25": true, "dev.semgrep.actions": ["monitor"], "display-name": "SQL Injection with Gorilla", "functional-categories": ["db::search::password::database", "db::search::password::gorm", "db::search::password::mysql", "db::search::password::pg", "db::search::password::pgx", "db::sink::sql-or-nosql-query::database", "net::source::network-connection::gorilla", "web::source::cookie::gorilla", "web::source::form-data::gorilla"], "impact": "HIGH", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/", "https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 59526, "rule_id": "7KU0kA", "rule_name": "go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "rv_id": 924126, "url": "https://semgrep.dev/playground/r/ZRTeZKr/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "version_id": "ZRTeZKr"}, "src": "unchanged"}, "semgrep.policy": {"id": 110389, "name": "Rule Board - Audit column", "slug": "rule-board-audit"}, "semgrep.url": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "shortlink": "https://sg.run/bdBQ", "source": "https://semgrep.dev/r/go.gorilla.sql.gorilla-go-vanillasql-format-string-sqli-taint.gorilla-go-vanillasql-format-string-sqli-taint", "subcategory": ["vuln"], "technology": ["database/sql", "github.com/gorilla/rpc/v2", "github.com/gorilla/schema", "github.com/gorilla/securecookie", "github.com/gorilla/sessions", "github.com/gorilla/websocket", "gorilla", "gorilla/rpc", "gorilla/schema", "gorilla/securecookie", "gorilla/sessions", "gorilla/websocket"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Open", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$A": {"abstract_content": "SELECT name FROM users WHERE email=", "end": {"col": 50, "line": 112, "offset": 3221}, "start": {"col": 15, "line": 112, "offset": 3186}}, "$B": {"abstract_content": "email", "end": {"col": 59, "line": 112, "offset": 3230}, "propagated_value": {"svalue_abstract_content": "session.Values[\"email\"]", "svalue_end": {"col": 37, "line": 109, "offset": 3106}, "svalue_start": {"col": 14, "line": 109, "offset": 3083}}, "start": {"col": 54, "line": 112, "offset": 3225}}, "$DB": {"abstract_content": "db", "end": {"col": 4, "line": 114, "offset": 3293}, "start": {"col": 2, "line": 114, "offset": 3291}}, "$METHOD": {"abstract_content": "Query", "end": {"col": 10, "line": 114, "offset": 3299}, "start": {"col": 5, "line": 114, "offset": 3294}}, "$OPEN": {"abstract_content": "Open", "end": {"col": 21, "line": 111, "offset": 3128}, "start": {"col": 17, "line": 111, "offset": 3124}}, "$QUERY": {"abstract_content": "query", "end": {"col": 16, "line": 114, "offset": 3305}, "propagated_value": {"svalue_abstract_content": "\"SELECT name FROM users WHERE email=\"+email", "svalue_end": {"col": 59, "line": 112, "offset": 3230}, "svalue_start": {"col": 14, "line": 112, "offset": 3185}}, "start": {"col": 11, "line": 114, "offset": 3300}}, "$SESSION": {"abstract_content": "session", "end": {"col": 21, "line": 109, "offset": 3090}, "start": {"col": 14, "line": 109, "offset": 3083}}, "$STORE": {"abstract_content": "store", "end": {"col": 23, "line": 103, "offset": 2955}, "start": {"col": 18, "line": 103, "offset": 2950}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "go/gorilla-go-vanillasql-format-string-sqli-taint.go", "start": {"col": 11, "line": 114, "offset": 3300}}], "skipped_rules": [], "version": "1.96.0"}